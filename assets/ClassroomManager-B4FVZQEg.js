import{c as T,r as N,k as be,v as ye,o as Ut,j as e,b as p,i as Gt,w as Ve,x as P,h as Bt,S as Ht,M as Vt,y as Xe,G as re,z as ce,P as Ye,d as ae,C as Xt,e as Yt,g as le,E as qt,R as Wt,X as ee,A as qe,D as We,f as Jt}from"./index-FQBKIusJ.js";import{I as Kt,A as Je,a as Ke,u as Qt}from"./useHotkeys-OKdVgLCj.js";import{C as Zt,D as es,S as ct,E as ts,U as je,b as ss,c as Qe,L as rs,T as as,a as ls}from"./SoundBoard-07BFhUNf.js";import{B as xt,P as ns,S as mt}from"./save-CF8G8tc3.js";import{T as os,M as is,R as ds,S as cs}from"./timer-C1Lo72OE.js";import{V as xs,P as xe}from"./volume-2-DF--ebQ2.js";import{C as ms,c as k,a as Ze,A as hs}from"./AttendanceModal-VEy16hDY.js";const us=[["rect",{width:"14",height:"6",x:"5",y:"16",rx:"2",key:"1i8z2d"}],["rect",{width:"10",height:"6",x:"7",y:"6",rx:"2",key:"13squh"}],["path",{d:"M2 2h20",key:"1ennik"}]],bs=T("align-vertical-justify-start",us);const gs=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],et=T("arrow-left-right",gs);const ps=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],fs=T("calendar-days",ps);const ks=[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]],vs=T("chart-column-increasing",ks);const ys=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],js=T("chart-column",ys);const ws=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ns=T("chevron-up",ws);const Cs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}],["path",{d:"M8 12h8",key:"1wcyev"}]],Ss=T("circle-arrow-right",Cs);const $s=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ht=T("crown",$s);const Ts=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],Es=T("eraser",Ts);const Ms=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],zs=T("eye-off",Ms);const _s=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Rs=T("folder-open",_s);const Ds=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Is=T("frown",Ds);const As=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],Ls=T("gift",As);const Os=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],ut=T("graduation-cap",Os);const Ps=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Fs=T("grip-vertical",Ps);const Us=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Gs=T("history",Us);const Bs=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],bt=T("layers",Bs);const Hs=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],gt=T("layout-dashboard",Hs);const Vs=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],pt=T("layout-grid",Vs);const Xs=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],ft=T("lock-open",Xs);const Ys=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],kt=T("lock",Ys);const qs=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Ws=T("map",qs);const Js=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],Ks=T("mouse-pointer-click",Js);const Qs=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],Zs=T("move",Qs);const er=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],tr=T("palette",er);const sr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],rr=T("panel-left-close",sr);const ar=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],lr=T("panel-left-open",ar);const nr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]],or=T("panel-right",nr);const ir=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],dr=T("printer",ir);const cr=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],xr=T("rotate-cw",cr);const mr=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],hr=T("scale",mr);const ur=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],br=T("school",ur);const gr=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],vt=T("settings-2",gr);const pr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],fr=T("smile",pr);const kr=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],yt=T("table",kr);const vr=[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]],yr=T("thumbs-down",vr);const jr=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],wr=T("thumbs-up",jr);const Nr=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],fe=T("trending-up",Nr);const Cr=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],me=T("trophy",Cr);function Sr(t,s){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const r=document.implementation.createHTMLDocument(),a=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(a),r.body.appendChild(o),s&&(a.href=s),o.href=t,o.href}const $r=(()=>{let t=0;const s=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${s()}${t}`)})();function Z(t){const s=[];for(let r=0,a=t.length;r<a;r++)s.push(t[r]);return s}let ie=null;function jt(t={}){return ie||(t.includeStyleProperties?(ie=t.includeStyleProperties,ie):(ie=Z(window.getComputedStyle(document.documentElement)),ie))}function ke(t,s){const a=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(s);return a?parseFloat(a.replace("px","")):0}function Tr(t){const s=ke(t,"border-left-width"),r=ke(t,"border-right-width");return t.clientWidth+s+r}function Er(t){const s=ke(t,"border-top-width"),r=ke(t,"border-bottom-width");return t.clientHeight+s+r}function wt(t,s={}){const r=s.width||Tr(t),a=s.height||Er(t);return{width:r,height:a}}function Mr(){let t,s;try{s=process}catch{}const r=s&&s.env?s.env.devicePixelRatio:null;return r&&(t=parseInt(r,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Y=16384;function zr(t){(t.width>Y||t.height>Y)&&(t.width>Y&&t.height>Y?t.width>t.height?(t.height*=Y/t.width,t.width=Y):(t.width*=Y/t.height,t.height=Y):t.width>Y?(t.height*=Y/t.width,t.width=Y):(t.width*=Y/t.height,t.height=Y))}function ve(t){return new Promise((s,r)=>{const a=new Image;a.onload=()=>{a.decode().then(()=>{requestAnimationFrame(()=>s(a))})},a.onerror=r,a.crossOrigin="anonymous",a.decoding="async",a.src=t})}async function _r(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(s=>`data:image/svg+xml;charset=utf-8,${s}`)}async function Rr(t,s,r){const a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),n=document.createElementNS(a,"foreignObject");return o.setAttribute("width",`${s}`),o.setAttribute("height",`${r}`),o.setAttribute("viewBox",`0 0 ${s} ${r}`),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("externalResourcesRequired","true"),o.appendChild(n),n.appendChild(t),_r(o)}const H=(t,s)=>{if(t instanceof s)return!0;const r=Object.getPrototypeOf(t);return r===null?!1:r.constructor.name===s.name||H(r,s)};function Dr(t){const s=t.getPropertyValue("content");return`${t.cssText} content: '${s.replace(/'|"/g,"")}';`}function Ir(t,s){return jt(s).map(r=>{const a=t.getPropertyValue(r),o=t.getPropertyPriority(r);return`${r}: ${a}${o?" !important":""};`}).join(" ")}function Ar(t,s,r,a){const o=`.${t}:${s}`,n=r.cssText?Dr(r):Ir(r,a);return document.createTextNode(`${o}{${n}}`)}function tt(t,s,r,a){const o=window.getComputedStyle(t,r),n=o.getPropertyValue("content");if(n===""||n==="none")return;const i=$r();try{s.className=`${s.className} ${i}`}catch{return}const l=document.createElement("style");l.appendChild(Ar(i,r,o,a)),s.appendChild(l)}function Lr(t,s,r){tt(t,s,":before",r),tt(t,s,":after",r)}const st="application/font-woff",rt="image/jpeg",Or={woff:st,woff2:st,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:rt,jpeg:rt,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function Pr(t){const s=/\.([^./]*?)$/g.exec(t);return s?s[1]:""}function Re(t){const s=Pr(t).toLowerCase();return Or[s]||""}function Fr(t){return t.split(/,/)[1]}function _e(t){return t.search(/^(data:)/)!==-1}function Ur(t,s){return`data:${s};base64,${t}`}async function Nt(t,s,r){const a=await fetch(t,s);if(a.status===404)throw new Error(`Resource "${a.url}" not found`);const o=await a.blob();return new Promise((n,i)=>{const l=new FileReader;l.onerror=i,l.onloadend=()=>{try{n(r({res:a,result:l.result}))}catch(d){i(d)}},l.readAsDataURL(o)})}const ze={};function Gr(t,s,r){let a=t.replace(/\?.*/,"");return r&&(a=t),/ttf|otf|eot|woff2?/i.test(a)&&(a=a.replace(/.*\//,"")),s?`[${s}]${a}`:a}async function De(t,s,r){const a=Gr(t,s,r.includeQueryParams);if(ze[a]!=null)return ze[a];r.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let o;try{const n=await Nt(t,r.fetchRequestInit,({res:i,result:l})=>(s||(s=i.headers.get("Content-Type")||""),Fr(l)));o=Ur(n,s)}catch(n){o=r.imagePlaceholder||"";let i=`Failed to fetch resource: ${t}`;n&&(i=typeof n=="string"?n:n.message),i&&console.warn(i)}return ze[a]=o,o}async function Br(t){const s=t.toDataURL();return s==="data:,"?t.cloneNode(!1):ve(s)}async function Hr(t,s){if(t.currentSrc){const n=document.createElement("canvas"),i=n.getContext("2d");n.width=t.clientWidth,n.height=t.clientHeight,i?.drawImage(t,0,0,n.width,n.height);const l=n.toDataURL();return ve(l)}const r=t.poster,a=Re(r),o=await De(r,a,s);return ve(o)}async function Vr(t,s){var r;try{if(!((r=t?.contentDocument)===null||r===void 0)&&r.body)return await we(t.contentDocument.body,s,!0)}catch{}return t.cloneNode(!1)}async function Xr(t,s){return H(t,HTMLCanvasElement)?Br(t):H(t,HTMLVideoElement)?Hr(t,s):H(t,HTMLIFrameElement)?Vr(t,s):t.cloneNode(Ct(t))}const Yr=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",Ct=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function qr(t,s,r){var a,o;if(Ct(s))return s;let n=[];return Yr(t)&&t.assignedNodes?n=Z(t.assignedNodes()):H(t,HTMLIFrameElement)&&(!((a=t.contentDocument)===null||a===void 0)&&a.body)?n=Z(t.contentDocument.body.childNodes):n=Z(((o=t.shadowRoot)!==null&&o!==void 0?o:t).childNodes),n.length===0||H(t,HTMLVideoElement)||await n.reduce((i,l)=>i.then(()=>we(l,r)).then(d=>{d&&s.appendChild(d)}),Promise.resolve()),s}function Wr(t,s,r){const a=s.style;if(!a)return;const o=window.getComputedStyle(t);o.cssText?(a.cssText=o.cssText,a.transformOrigin=o.transformOrigin):jt(r).forEach(n=>{let i=o.getPropertyValue(n);n==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),H(t,HTMLIFrameElement)&&n==="display"&&i==="inline"&&(i="block"),n==="d"&&s.getAttribute("d")&&(i=`path(${s.getAttribute("d")})`),a.setProperty(n,i,o.getPropertyPriority(n))})}function Jr(t,s){H(t,HTMLTextAreaElement)&&(s.innerHTML=t.value),H(t,HTMLInputElement)&&s.setAttribute("value",t.value)}function Kr(t,s){if(H(t,HTMLSelectElement)){const a=Array.from(s.children).find(o=>t.value===o.getAttribute("value"));a&&a.setAttribute("selected","")}}function Qr(t,s,r){return H(s,Element)&&(Wr(t,s,r),Lr(t,s,r),Jr(t,s),Kr(t,s)),s}async function Zr(t,s){const r=t.querySelectorAll?t.querySelectorAll("use"):[];if(r.length===0)return t;const a={};for(let n=0;n<r.length;n++){const l=r[n].getAttribute("xlink:href");if(l){const d=t.querySelector(l),x=document.querySelector(l);!d&&x&&!a[l]&&(a[l]=await we(x,s,!0))}}const o=Object.values(a);if(o.length){const n="http://www.w3.org/1999/xhtml",i=document.createElementNS(n,"svg");i.setAttribute("xmlns",n),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const l=document.createElementNS(n,"defs");i.appendChild(l);for(let d=0;d<o.length;d++)l.appendChild(o[d]);t.appendChild(i)}return t}async function we(t,s,r){return!r&&s.filter&&!s.filter(t)?null:Promise.resolve(t).then(a=>Xr(a,s)).then(a=>qr(t,a,s)).then(a=>Qr(t,a,s)).then(a=>Zr(a,s))}const St=/url\((['"]?)([^'"]+?)\1\)/g,ea=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ta=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function sa(t){const s=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${s})(['"]?\\))`,"g")}function ra(t){const s=[];return t.replace(St,(r,a,o)=>(s.push(o),r)),s.filter(r=>!_e(r))}async function aa(t,s,r,a,o){try{const n=r?Sr(s,r):s,i=Re(s);let l;return o||(l=await De(n,i,a)),t.replace(sa(s),`$1${l}$3`)}catch{}return t}function la(t,{preferredFontFormat:s}){return s?t.replace(ta,r=>{for(;;){const[a,,o]=ea.exec(r)||[];if(!o)return"";if(o===s)return`src: ${a};`}}):t}function $t(t){return t.search(St)!==-1}async function Tt(t,s,r){if(!$t(t))return t;const a=la(t,r);return ra(a).reduce((n,i)=>n.then(l=>aa(l,i,s,r)),Promise.resolve(a))}async function de(t,s,r){var a;const o=(a=s.style)===null||a===void 0?void 0:a.getPropertyValue(t);if(o){const n=await Tt(o,null,r);return s.style.setProperty(t,n,s.style.getPropertyPriority(t)),!0}return!1}async function na(t,s){await de("background",t,s)||await de("background-image",t,s),await de("mask",t,s)||await de("-webkit-mask",t,s)||await de("mask-image",t,s)||await de("-webkit-mask-image",t,s)}async function oa(t,s){const r=H(t,HTMLImageElement);if(!(r&&!_e(t.src))&&!(H(t,SVGImageElement)&&!_e(t.href.baseVal)))return;const a=r?t.src:t.href.baseVal,o=await De(a,Re(a),s);await new Promise((n,i)=>{t.onload=n,t.onerror=s.onImageErrorHandler?(...d)=>{try{n(s.onImageErrorHandler(...d))}catch(x){i(x)}}:i;const l=t;l.decode&&(l.decode=n),l.loading==="lazy"&&(l.loading="eager"),r?(t.srcset="",t.src=o):t.href.baseVal=o})}async function ia(t,s){const a=Z(t.childNodes).map(o=>Et(o,s));await Promise.all(a).then(()=>t)}async function Et(t,s){H(t,Element)&&(await na(t,s),await oa(t,s),await ia(t,s))}function da(t,s){const{style:r}=t;s.backgroundColor&&(r.backgroundColor=s.backgroundColor),s.width&&(r.width=`${s.width}px`),s.height&&(r.height=`${s.height}px`);const a=s.style;return a!=null&&Object.keys(a).forEach(o=>{r[o]=a[o]}),t}const at={};async function lt(t){let s=at[t];if(s!=null)return s;const a=await(await fetch(t)).text();return s={url:t,cssText:a},at[t]=s,s}async function nt(t,s){let r=t.cssText;const a=/url\(["']?([^"')]+)["']?\)/g,n=(r.match(/url\([^)]+\)/g)||[]).map(async i=>{let l=i.replace(a,"$1");return l.startsWith("https://")||(l=new URL(l,t.url).href),Nt(l,s.fetchRequestInit,({result:d})=>(r=r.replace(i,`url(${d})`),[i,d]))});return Promise.all(n).then(()=>r)}function ot(t){if(t==null)return[];const s=[],r=/(\/\*[\s\S]*?\*\/)/gi;let a=t.replace(r,"");const o=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=o.exec(a);if(d===null)break;s.push(d[0])}a=a.replace(o,"");const n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(i,"gi");for(;;){let d=n.exec(a);if(d===null){if(d=l.exec(a),d===null)break;n.lastIndex=l.lastIndex}else l.lastIndex=n.lastIndex;s.push(d[0])}return s}async function ca(t,s){const r=[],a=[];return t.forEach(o=>{if("cssRules"in o)try{Z(o.cssRules||[]).forEach((n,i)=>{if(n.type===CSSRule.IMPORT_RULE){let l=i+1;const d=n.href,x=lt(d).then(m=>nt(m,s)).then(m=>ot(m).forEach(h=>{try{o.insertRule(h,h.startsWith("@import")?l+=1:o.cssRules.length)}catch(u){console.error("Error inserting rule from remote css",{rule:h,error:u})}})).catch(m=>{console.error("Error loading remote css",m.toString())});a.push(x)}})}catch(n){const i=t.find(l=>l.href==null)||document.styleSheets[0];o.href!=null&&a.push(lt(o.href).then(l=>nt(l,s)).then(l=>ot(l).forEach(d=>{i.insertRule(d,i.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",n)}}),Promise.all(a).then(()=>(t.forEach(o=>{if("cssRules"in o)try{Z(o.cssRules||[]).forEach(n=>{r.push(n)})}catch(n){console.error(`Error while reading CSS rules from ${o.href}`,n)}}),r))}function xa(t){return t.filter(s=>s.type===CSSRule.FONT_FACE_RULE).filter(s=>$t(s.style.getPropertyValue("src")))}async function ma(t,s){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=Z(t.ownerDocument.styleSheets),a=await ca(r,s);return xa(a)}function Mt(t){return t.trim().replace(/["']/g,"")}function ha(t){const s=new Set;function r(a){(a.style.fontFamily||getComputedStyle(a).fontFamily).split(",").forEach(n=>{s.add(Mt(n))}),Array.from(a.children).forEach(n=>{n instanceof HTMLElement&&r(n)})}return r(t),s}async function ua(t,s){const r=await ma(t,s),a=ha(t);return(await Promise.all(r.filter(n=>a.has(Mt(n.style.fontFamily))).map(n=>{const i=n.parentStyleSheet?n.parentStyleSheet.href:null;return Tt(n.cssText,i,s)}))).join(`
`)}async function ba(t,s){const r=s.fontEmbedCSS!=null?s.fontEmbedCSS:s.skipFonts?null:await ua(t,s);if(r){const a=document.createElement("style"),o=document.createTextNode(r);a.appendChild(o),t.firstChild?t.insertBefore(a,t.firstChild):t.appendChild(a)}}async function ga(t,s={}){const{width:r,height:a}=wt(t,s),o=await we(t,s,!0);return await ba(o,s),await Et(o,s),da(o,s),await Rr(o,r,a)}async function pa(t,s={}){const{width:r,height:a}=wt(t,s),o=await ga(t,s),n=await ve(o),i=document.createElement("canvas"),l=i.getContext("2d"),d=s.pixelRatio||Mr(),x=s.canvasWidth||r,m=s.canvasHeight||a;return i.width=x*d,i.height=m*d,s.skipAutoScale||zr(i),i.style.width=`${x}`,i.style.height=`${m}`,s.backgroundColor&&(l.fillStyle=s.backgroundColor,l.fillRect(0,0,i.width,i.height)),l.drawImage(n,0,0,i.width,i.height),i}async function fa(t,s={}){return(await pa(t,s)).toDataURL()}const ka=()=>{const t=d=>{const x=Number(String(d).trim());return Number.isFinite(x)?x:null},s=d=>{const x=String(d).trim();return["F","M","女","男","女生","男生","f","m"].includes(x)},r=d=>{const x=String(d).trim().toUpperCase();return x==="F"||x.startsWith("女")?"F":"M"},a=d=>{const x=String(d).trim();if(!x)return null;const m={零:0,一:1,二:2,兩:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9};if(x==="十")return 10;if(x.length===1&&m.hasOwnProperty(x))return m[x];const h=x.indexOf("十");if(h>=0){const u=x.slice(0,h),y=x.slice(h+1),w=u===""?1:m[u]??null;if(w==null)return null;const b=y===""?0:m[y]??null;return b==null?null:w*10+b}return null},o=d=>{const x=String(d).trim();if(!x)return null;let m=x.match(/^(?:G|g)\s*(\d+)$/)||x.match(/^(?:Group|group)\s*(\d+)$/);if(m||(m=x.match(/^(\d+)\s*組$/),m))return parseInt(m[1],10);if(m=x.match(/^第?\s*([零一二兩三四五六七八九十]{1,3})\s*組$/),m){const u=a(m[1]);return u??null}const h=a(x);return h??null},n=d=>{const x=String(d).trim();if(!x)return null;let m=x.match(/^(\d+(?:\.\d+)?)\s*分$/);return m||(m=x.match(/^(?:S|s)\s*(\d+(?:\.\d+)?)$/),m)?parseFloat(m[1],10):t(x)},i=d=>{let x="",m=null;const h=d[0]??"",u=d[1]??"";if(!h&&!u)return{group:x,performance:m};if(h&&!u){const b=o(h);if(b!=null)return{group:String(b),performance:null};const f=n(h);return f!=null?f>=10?{group:"",performance:f}:{group:String(f),performance:null}:{group:h,performance:null}}const y=o(h);y!=null?x=String(y):x=h;const w=n(u);return w!=null?m=w:x=x?`${x} ${u}`:u,{group:x,performance:m}};return{parseImportText:N.useCallback(d=>{const x=d.split(/\r?\n/).map(h=>h.trim()).filter(Boolean),m=[];for(const h of x){const u=h.split(/[\t\s,]+/).filter(Boolean);if(u.length<2)continue;const y=u[0].trim(),w=u[1].trim();let b="M",f=[];u.length>=3&&s(u[2])?(b=r(u[2]),f=u.slice(3,5)):f=u.slice(2,4);const{group:j,performance:c}=i(f);m.push({id:typeof crypto<"u"&&crypto.randomUUID?`s_${crypto.randomUUID()}`:`s_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,number:y,name:w,gender:b,group:j,performance:c,locked:!1})}return m},[])}},va=({isSidebarOpen:t,setIsSidebarOpen:s,isToolbarOpen:r,setIsToolbarOpen:a,appMode:o,handleSwitchMode:n,setIsLotteryOpen:i,setIsTimerOpen:l,isTimerOpen:d,isLotteryOpen:x,isSoundBoardOpen:m,setIsSoundBoardOpen:h,isScoreTickerOpen:u,setIsScoreTickerOpen:y,showShuffleMenu:w,setShowShuffleMenu:b,cycleDisplayMode:f,getDisplayModeLabel:j,isTeacherView:c,setIsTeacherView:v,handleExportImage:C,toggleFullscreen:M,isFocusMode:g,setIsFocusMode:_})=>{const{classes:E,currentClass:z,setCurrentClassId:D,updateClass:A,clearSeats:S,shuffleSeats:F,seatMode:O,setSeatMode:L}=be(),{openModal:V,openDialog:G,closeDialog:te}=ye(),{theme:ne,cycleTheme:q}=Ut(),J=z.layout,$=X=>{F(X),b(!1)},U=()=>{G({type:"confirm",title:"清空座位表",message:`確定要清空目前的座位表嗎？
學生將回到未排區，但分數與分組紀錄會保留。`,variant:"danger",confirmText:"清空",onConfirm:()=>{S(),te()}})},se=()=>{_(!0),setTimeout(()=>{window.print()},500)},W=()=>ne==="system"?e.jsx(Bt,{size:18}):ne==="light"?e.jsx(Ht,{size:18}):e.jsx(Vt,{size:18});if(!r)return g?null:e.jsx("div",{className:"absolute top-0 left-0 right-0 flex justify-center z-[60] no-print pointer-events-none",children:e.jsxs("button",{onClick:()=>a(!0),className:"mt-2 pointer-events-auto px-4 py-1.5 bg-white/90 dark:bg-slate-800/90 backdrop-blur text-slate-600 dark:text-slate-300 rounded-full shadow-lg font-bold text-xs flex items-center gap-2 hover:scale-105 transition-all border border-slate-200 dark:border-slate-700",children:[e.jsx(Zt,{size:14})," 工具列"]})});const B="px-3 py-2 rounded-xl font-bold text-sm flex items-center gap-2 transition-all select-none hover:bg-slate-100 dark:hover:bg-slate-700/50 active:scale-95",K="h-8 w-px bg-slate-200 dark:bg-slate-700 mx-1";return e.jsxs("div",{className:`
        absolute top-0 left-0 right-0 z-[60] no-print
        p-3 flex flex-wrap items-center justify-between gap-3
        transition-all duration-300 ease-in-out
        ${p.SURFACE_GLASS} border-b ${p.BORDER_LIGHT} shadow-sm
    `,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[!t&&!g&&e.jsx("button",{onClick:()=>s(!0),className:`${B} px-2`,title:"開啟側邊欄",children:e.jsx(lr,{size:20})}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 dark:bg-slate-800/50 rounded-xl border border-transparent hover:border-slate-200 dark:hover:border-slate-700 transition-all",children:[e.jsx(br,{size:16,className:"text-slate-400 dark:text-slate-500"}),e.jsx("select",{id:"class-selector",name:"Class",value:z.id,onChange:X=>D(X.target.value),className:"text-sm font-bold bg-transparent outline-none cursor-pointer min-w-[100px] text-slate-700 dark:text-slate-200",children:E.map(X=>e.jsx("option",{value:X.id,className:"bg-white dark:bg-slate-900",children:X.name},X.id))})]}),e.jsx("div",{className:K}),e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800/50 p-1 rounded-xl",children:[e.jsxs("button",{onClick:()=>v(!0),className:`px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-1.5 transition-all ${c?"bg-white dark:bg-slate-700 text-blue-600 dark:text-blue-300 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:[e.jsx(Gt,{size:14})," 老師"]}),e.jsxs("button",{onClick:()=>v(!1),className:`px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-1.5 transition-all ${c?"text-slate-400 hover:text-slate-600":"bg-white dark:bg-slate-700 text-emerald-600 dark:text-emerald-300 shadow-sm"}`,children:[e.jsx(ut,{size:14})," 學生"]})]})]}),e.jsx("div",{className:"flex items-center justify-center flex-1 min-w-[300px]",children:e.jsxs("div",{className:"flex items-center gap-3 p-1.5 bg-white/50 dark:bg-slate-800/30 rounded-2xl border border-slate-200/50 dark:border-slate-700/50 backdrop-blur-sm shadow-sm",children:[e.jsxs("div",{className:"flex bg-slate-800 dark:bg-slate-950 rounded-xl p-1 shadow-inner",children:[e.jsxs("button",{onClick:()=>n("score"),className:`px-4 py-1.5 rounded-lg text-sm font-bold flex items-center gap-2 transition-all ${o==="score"?"bg-amber-400 text-amber-950 shadow-md":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(xt,{size:16})," 工具"]}),e.jsxs("button",{onClick:()=>n("arrange"),className:`px-4 py-1.5 rounded-lg text-sm font-bold flex items-center gap-2 transition-all ${o==="arrange"?"bg-white text-slate-950 shadow-md":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(Zs,{size:16})," 編輯"]})]}),e.jsx("div",{className:"w-px h-6 bg-slate-300 dark:bg-slate-600"}),o==="score"?e.jsxs("div",{className:"flex items-center gap-1 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("button",{onClick:()=>i(!x),className:`${x?"bg-pink-100 dark:bg-rose-900/30 text-rose-900 dark:text-white":""} ${B}`,title:"抽籤",children:[e.jsx(es,{size:18,className:x?"text-pink-600":"text-rose-500"}),e.jsx("span",{className:"hidden xl:inline",children:"抽籤"})]}),e.jsxs("button",{onClick:()=>l(!d),className:`${d?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-900 dark:text-white":""} ${B}`,title:"計時",children:[e.jsx(os,{size:18,className:d?"text-emerald-600":"text-emerald-500"})," ",e.jsx("span",{className:"hidden xl:inline",children:"計時"})]}),e.jsxs("button",{onClick:()=>h(!m),className:`${m?"bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600  dark:text-white":""} ${B}`,title:"音效板",children:[e.jsx(xs,{size:18,className:m?"text-indigo-600":"text-blue-500 "}),e.jsx("span",{className:"hidden xl:inline",children:"音效"})]}),e.jsxs("button",{onClick:()=>y(!u),className:`${u?"bg-amber-100 dark:bg-amber-900/30 text-amber-700  dark:text-white":""} ${B}`,title:"顯示評分工具",children:[e.jsx(vs,{size:18,className:u?"text-amber-600":"text-amber-400"}),e.jsx("span",{className:"hidden xl:inline",children:"加分"})]})]}):e.jsxs("div",{className:"flex items-center gap-1 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-lg mr-2",children:[e.jsx("button",{onClick:()=>L("swap"),className:`p-1.5 rounded ${O==="swap"?"bg-white dark:bg-purple-600 shadow text-purple-500 dark:text-white":"text-slate-400 hover:text-white"}`,title:"交換座位",children:e.jsx(et,{size:16})}),e.jsx("button",{onClick:()=>L("replace"),className:`p-1.5 rounded ${O==="replace"?"bg-white dark:bg-blue-600 shadow text-blue-500 dark:text-white":"text-slate-400 hover:text-white"}`,title:"取代座位",children:e.jsx(Ss,{size:16})})]}),e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 p-1 rounded-xl flex items-center",children:[e.jsx("button",{onClick:()=>A({...z,layout:{...z.layout,doorSide:"left"}}),className:`px-3 py-1.5 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${J.doorSide==="left"?"bg-white dark:bg-slate-700 text-amber-600 dark:text-amber-400 shadow-sm":"text-slate-500 dark:text-slate-400"}`,title:"門在左",children:e.jsx(ns,{size:16})}),e.jsx("button",{onClick:()=>A({...z,layout:{...z.layout,doorSide:"right"}}),className:`px-3 py-1.5 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${!J.doorSide||J.doorSide==="right"?"bg-white dark:bg-slate-700 text-amber-600 dark:text-amber-400 shadow-sm":"text-slate-500 dark:text-slate-400"}`,title:"門在右",children:e.jsx(or,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-black text-slate-800 dark:text-white",children:[e.jsx("input",{type:"number",min:"1",max:"10",value:J.rows,onChange:X=>A({...z,layout:{...z.layout,rows:Number(X.target.value)}}),className:`w-12 text-center p-1 ${p.INPUT_BASE} transition-colors`}),"排",e.jsx("span",{className:"text-slate-400",children:"x"}),e.jsx("input",{type:"number",min:"1",max:"10",value:J.cols,onChange:X=>A({...z,layout:{...z.layout,cols:Number(X.target.value)}}),className:`w-12 text-center p-1 ${p.INPUT_BASE} transition-colors`}),"列"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>b(!w),className:`${B} ${w?"bg-slate-200 dark:bg-slate-700":""}`,children:[e.jsx(ct,{size:18,className:"text-purple-500"})," ",e.jsx("span",{className:"hidden xl:inline",children:"自動"})]}),w&&e.jsxs("div",{className:`absolute top-full left-0 mt-2 w-56 ${p.SURFACE_CARD} rounded-xl shadow-2xl border ${p.BORDER_LIGHT} p-2 flex flex-col gap-1 z-50 animate-in slide-in-from-top-2`,children:[e.jsxs("button",{onClick:()=>$("random"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(pt,{size:14})," 完全隨機"]}),e.jsx("div",{className:`my-1 border-t ${p.BORDER_LIGHT}`}),e.jsxs("button",{onClick:()=>$("group_vertical"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(bs,{size:14})," 依組別：直排"]}),e.jsxs("button",{onClick:()=>$("group_cluster"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(gt,{size:14})," 依組別：區塊"]}),e.jsx("div",{className:`my-1 border-t ${p.BORDER_LIGHT}`}),e.jsxs("button",{onClick:()=>$("row_gender"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(et,{size:14,className:"rotate-90"})," 性別: 前後錯開"]}),e.jsxs("button",{onClick:()=>$("checker"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(Ve,{size:14})," 性別: 梅花座"]}),e.jsx("div",{className:`my-1 border-t ${p.BORDER_LIGHT}`}),e.jsxs("button",{onClick:()=>$("performance_s_shape"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(fe,{size:14})," 成績: S 型排列"]}),e.jsxs("button",{onClick:()=>$("performance_checker"),className:`text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-bold flex items-center gap-2 ${p.TEXT_PRIMARY}`,children:[e.jsx(Ve,{size:14})," 成績: 梅花座"]})]})]}),e.jsxs("button",{onClick:()=>V(P.LAYOUT_TEMPLATE),className:B,title:"樣板管理",children:[e.jsx(Rs,{size:18,className:"text-orange-500"})," ",e.jsx("span",{className:"hidden xl:inline",children:"樣板"})]}),e.jsx("div",{className:"w-px h-6 bg-slate-300 dark:bg-slate-600 mx-1"}),e.jsx("button",{onClick:U,className:`text-red-500 dark:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 ${B}`,title:"清空座位",children:e.jsx(Es,{size:18})})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:f,className:`${B} min-w-[100px] justify-center hidden md:flex`,title:"切換顯示模式",children:[e.jsx(tr,{size:16})," ",j()]}),e.jsx("div",{className:K}),e.jsx("button",{onClick:q,className:B,title:"切換主題",children:W()}),e.jsx("button",{onClick:()=>_(!g),className:`${g?"bg-indigo-600 text-white shadow-md hover:bg-indigo-700":B}`,title:g?"退出專注模式":"進入專注模式",children:g?e.jsx(zs,{size:18}):e.jsx(ts,{size:18})}),e.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-800/50 p-1 rounded-xl",children:[e.jsx("button",{onClick:se,className:"p-2 rounded-lg text-slate-500 hover:text-blue-600 hover:bg-white dark:hover:bg-slate-700 transition-all",title:"列印",children:e.jsx(dr,{size:18})}),e.jsx("button",{onClick:C,className:"p-2 rounded-lg text-slate-500 hover:text-blue-600 hover:bg-white dark:hover:bg-slate-700 transition-all",title:"匯出圖片",children:e.jsx(Kt,{size:18})}),e.jsx("button",{onClick:M,className:"p-2 rounded-lg text-slate-500 hover:text-slate-800 hover:bg-white dark:hover:bg-slate-700 transition-all",title:"全螢幕",children:e.jsx(is,{size:18})}),e.jsx("div",{className:"w-px h-4 bg-slate-300 dark:bg-slate-600 mx-1"}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 rounded-lg text-slate-400 hover:text-red-500 hover:bg-white dark:hover:bg-slate-700 transition-all",title:"收起工具列",children:e.jsx(Ns,{size:18})})]})]})]})},zt=N.memo(({student:t,isDragging:s,onDragStart:r,onClick:a,displayMode:o="normal",mode:n="view",attendanceStatus:i,onToggleLock:l,isMapEditActive:d})=>{if(!t)return null;const x=i?.[t.id]||t.status||"present",m=Xe[x]||Xe.present,h=!m.isPresent,u=()=>{let c="border-slate-500 bg-white text-slate-900 dark:border-slate-700 dark:bg-slate-900 dark:text-white shadow-sm",v="bg-slate-500 dark:bg-slate-600",C=null;if(o==="group"&&t.group){const M=String(t.group),g=parseInt(M),_=(isNaN(g)?M.charCodeAt(0):g)%9,E=re[_];c=`${E.border} ${E.bg} ${E.text}`,v="bg-slate-600 dark:bg-slate-500"}else if(o==="gender"){const M=ce[t.gender]||ce.M;c=`${M.border} ${M.bg} ${M.text}`,v=M.badge,C=M.decoration}return{styles:c,badge:v,decoration:C}},{styles:y,badge:w,decoration:b}=u(),f=n==="score"?"cursor-pointer hover:ring-4 ring-yellow-400 dark:ring-yellow-500/50 ring-opacity-50 hover:scale-105 active:scale-95":"cursor-move hover:scale-105 hover:shadow-md active:cursor-grabbing",j=c=>{c.stopPropagation(),l&&l(t.id)};return e.jsxs("div",{id:`student-card-${t.id}`,draggable:n==="arrange"&&!t.locked,onDragStart:c=>n==="arrange"&&!t.locked&&r&&r(c,t.id),onClick:a,className:`
        relative p-1.5 rounded-xl border-2 select-none transition-all duration-200
        flex flex-col items-center justify-center gap-0.5 h-full w-full overflow-hidden
        ${y} 
        ${s?"opacity-40 scale-90":f} 
        ${h?"opacity-60 grayscale-[0.3]":""} 
        ${t.locked?"ring-2 ring-slate-400 dark:ring-slate-500 ring-offset-2 dark:ring-offset-slate-900":""}
        animate-fade-in
      `,title:t.locked?"已鎖定座位":"點擊進行操作",children:[h&&e.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-white/40 dark:bg-slate-900/70 backdrop-blur-[1px]",children:e.jsxs("div",{className:`flex flex-col items-center justify-center font-bold ${m.color}`,children:[m.icon,e.jsx("span",{className:"text-[10px] tracking-tighter",children:m.label})]})}),n==="arrange"&&!d&&e.jsx("div",{onClick:j,className:`
            absolute top-1 right-1 p-1 rounded-full z-30 shadow-sm border border-white dark:border-slate-800 transition-colors cursor-pointer
            ${t.locked?"bg-slate-700 text-white":"bg-slate-100 text-slate-400 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-500"}
          `,title:t.locked?"點擊解鎖":"點擊鎖定",children:t.locked?e.jsx(kt,{size:14,fill:"currentColor"}):e.jsx(ft,{size:14})}),o==="group"&&t.group&&e.jsxs("div",{className:"absolute bottom-0.5 right-0.5 px-1.5 py-0.5 bg-black/5 dark:bg-white/10 text-slate-500 dark:text-slate-300 rounded text-[12px] font-bold z-10",children:[t.group,"組"]}),t.score!==void 0&&t.score!==0&&e.jsxs("div",{className:`
          absolute bottom-1 left-1 min-w-[20px] h-7 px-1 py-0.5 rounded-full flex items-center justify-center text-[10px] font-black shadow-sm border border-white dark:border-slate-800 z-10
          ${t.score>0?"bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300 border border-amber-200 dark:border-amber-700":"bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300 border border-rose-200 dark:border-rose-700"}
        `,children:[t.score>0?"+":"",t.score]}),e.jsx("div",{className:`
        text-[14px] font-black px-1.5 py-0.5 rounded-full text-white leading-none mb-0.5 shadow-sm
        ${w}
      `,children:t.number}),e.jsx("div",{className:"font-bold text-current truncate w-full text-center text-lg md:text-sm lg:text-base leading-tight px-1",children:t.name}),o==="gender"&&b&&e.jsx("div",{className:`absolute bottom-0 right-0 w-6 h-6 rounded-tl-full opacity-10 pointer-events-none ${b}`})]})});zt.displayName="StudentCard";const ya=({isEditingList:t,setIsEditingList:s,onImportList:r,onStudentClick:a,onDragStart:o,onDrop:n,displayMode:i,appMode:l})=>{const{classes:d,currentClass:x,setCurrentClassId:m,unseatedStudents:h,addClass:u,updateClass:y,deleteClass:w,toggleLock:b}=be(),{openModal:f,openDialog:j,closeDialog:c}=ye(),v=N.useRef(null),C=new Date().toLocaleDateString("en-CA"),M=x?.attendanceRecords?.[C]||{},g=S=>{S.preventDefault(),S.dataTransfer.dropEffect="move"},_=S=>{S.preventDefault();const F=S.dataTransfer.getData("sourceSeat");F&&n&&n(F)},E=()=>{j({type:"prompt",title:"新增班級",message:"請輸入新班級的名稱：",placeholder:"例如：一年二班",confirmText:"新增",onConfirm:S=>{S&&S.trim()&&u(S),c()}})},z=()=>{j({type:"prompt",title:"重新命名",message:`請輸入「${x.name}」的新名稱：`,defaultValue:x.name,confirmText:"更新",onConfirm:S=>{S&&S.trim()&&y({...x,name:S.trim()}),c()}})},D=()=>{if(d.length<=1){j({type:"alert",title:"無法刪除",message:"這是最後一個班級，無法刪除。",variant:"warning",onConfirm:c});return}j({type:"confirm",title:"刪除班級",message:`確定要刪除「${x.name}」嗎？
此動作無法復原，所有相關的學生與紀錄將被移除。`,variant:"danger",confirmText:"確認刪除",onConfirm:()=>{w(),c()}})},A=()=>{v.current&&r&&r(v.current.value)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-4 space-y-2 border-b ${p.BORDER_LIGHT}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx("span",{className:`font-bold text-lg ${p.TEXT_PRIMARY} truncate max-w-[140px]`,title:x.name,children:x.name}),e.jsx("button",{onClick:z,className:`p-1 rounded-md ${p.BTN_GHOST}`,children:e.jsx(Ye,{size:14})}),e.jsx("button",{onClick:D,className:"p-1 rounded-md transition-colors text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30",children:e.jsx(ae,{size:14})})]}),e.jsxs("button",{onClick:E,className:"p-1.5 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/50 font-bold text-xs flex items-center gap-1 transition-colors",children:[e.jsx(xe,{size:14})," 新增"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 pb-2",children:d.map(S=>e.jsx("button",{onClick:()=>m(S.id),className:`px-2 py-1.5 rounded-md text-xs font-bold whitespace-nowrap border transition-colors truncate 
                      ${S.id===x.id?p.BTN_PRIMARY:p.BTN_SECONDARY}
                    `,children:S.name},S.id))}),e.jsxs("div",{className:`grid grid-cols-2 gap-2 mb-2 pt-2 border-t border-dashed ${p.BORDER_DEFAULT}`,children:[e.jsxs("button",{onClick:()=>f(P.ATTENDANCE),className:"py-2 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800 rounded-lg text-xs font-bold flex items-center justify-center gap-2 hover:bg-emerald-100 dark:hover:bg-emerald-900/40 transition-colors",children:[e.jsx(ms,{size:14})," 點名"]}),e.jsxs("button",{onClick:()=>f(P.BATCH_GROUP),className:"py-2 bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-400 border border-purple-200 dark:border-purple-800 rounded-lg text-xs font-bold flex items-center justify-center gap-2 hover:bg-purple-100 dark:hover:bg-purple-900/40 transition-colors",children:[e.jsx(bt,{size:14})," 批次分組"]})]})]}),e.jsxs("div",{className:`flex-1 overflow-hidden flex flex-col transition-colors duration-200 ${h.length===0?"bg-slate-50/30 dark:bg-slate-900/30":""}`,onDragOver:g,onDrop:_,children:[e.jsxs("div",{className:`px-4 py-2 border-y ${p.BORDER_LIGHT} flex justify-between items-center pointer-events-none bg-slate-50/50 dark:bg-slate-800/50`,children:[e.jsxs("span",{className:`text-xs font-bold ${p.TEXT_MUTED}`,children:["未排座位 (",h.length,")"]}),e.jsx("button",{onClick:()=>s(!0),className:`p-1.5 rounded-lg ${p.TEXT_MUTED} hover:text-blue-600 dark:hover:text-blue-400 pointer-events-auto transition-colors`,title:"匯入名單",children:e.jsx(Ye,{size:16})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 relative custom-scrollbar",children:t?e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsx("textarea",{ref:v,className:`flex-1 w-full p-2 ${p.INPUT_BASE} text-sm font-mono resize-none`,placeholder:"格式：座號 姓名 [性別] [組別] [參考成績]"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>s(!1),className:`flex-1 py-2 ${p.BTN_SECONDARY} text-sm font-bold`,children:"取消"}),e.jsx("button",{onClick:A,className:"flex-1 py-2 bg-blue-600 rounded-lg text-sm font-bold text-white shadow hover:bg-blue-700 transition-colors",children:"儲存"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 content-start min-h-full",children:[h.map(S=>e.jsx("div",{className:"aspect-[3/2]",children:e.jsx(zt,{student:S,onDragStart:F=>o(F,S.id),onClick:()=>a(S),displayMode:i,mode:l,attendanceStatus:M,onToggleLock:b})},S.id)),h.length===0&&e.jsxs("div",{className:`col-span-2 text-center py-8 ${p.TEXT_MUTED} text-sm flex flex-col items-center gap-2 pointer-events-none opacity-60`,children:[e.jsx(xt,{className:"text-slate-300 dark:text-slate-600",size:32}),e.jsx("span",{children:"全數已排位"}),e.jsx("span",{className:"text-xs text-slate-300 dark:text-slate-600 mt-2",children:"將學生拖曳至此以移除座位"})]})]})})]})]})},ja=()=>{const{currentClass:t,clearScoreLogs:s}=be(),{openModal:r,openDialog:a,closeDialog:o}=ye(),n=[...t.students].filter(l=>l.score!==void 0&&l.score!==0).sort((l,d)=>(d.score||0)-(l.score||0)).slice(0,10),i=t.scoreLogs?[...t.scoreLogs].reverse():[];return e.jsxs("div",{className:"flex-1 flex flex-col bg-slate-50/30 dark:bg-slate-900/30 overflow-hidden",children:[e.jsxs("div",{className:k("p-4 border-b flex flex-col gap-3",p.SURFACE_MAIN,p.BORDER_LIGHT),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:k("text-sm font-bold flex items-center gap-2",p.TEXT_SECONDARY),children:[e.jsx(me,{size:16,className:"text-yellow-500"})," 分數統計"]}),e.jsx("button",{onClick:()=>r(P.EXPORT_STATS),className:k("p-1.5 rounded",p.BTN_GHOST),title:"匯出成績",children:e.jsx(yt,{size:16})})]}),e.jsxs("button",{onClick:()=>r(P.BEHAVIOR_SETTINGS),className:k("w-full py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2",p.BTN_PRIMARY),children:[e.jsx(vt,{size:14})," 評分項目設定"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:k("text-xs font-bold mb-2 uppercase tracking-wider flex items-center gap-1",p.TEXT_MUTED),children:[e.jsx(je,{size:12})," 個人風雲榜 (Top 10)"]}),e.jsx("div",{className:k("rounded-xl border shadow-sm overflow-hidden",p.SURFACE_CARD,p.BORDER_LIGHT),children:n.length>0?e.jsx("table",{className:"w-full text-xs",children:e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-700",children:n.map((l,d)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:k("p-2 w-8 text-center font-bold",p.TEXT_MUTED),children:d<3?e.jsx(me,{size:12,className:d===0?"text-yellow-500":d===1?"text-slate-400":"text-amber-600"}):d+1}),e.jsx("td",{className:k("p-2 font-bold",p.TEXT_PRIMARY),children:l.name}),e.jsx("td",{className:"p-2 text-right font-mono font-bold text-emerald-600 dark:text-emerald-400",children:l.score})]},l.id))})}):e.jsx("div",{className:k("text-center text-xs py-4",p.TEXT_MUTED),children:"尚無個人分數"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:k("text-xs font-bold uppercase tracking-wider flex items-center gap-1",p.TEXT_MUTED),children:[e.jsx(Gs,{size:12})," 近期動態 (最新15筆)"]}),i.length>0&&e.jsx("button",{onClick:()=>a({type:"confirm",title:"清除紀錄",message:"確定清除所有近期動態紀錄嗎？分數本身不會受到影響。",variant:"warning",confirmText:"清除",onConfirm:()=>{s(),o()}}),className:"p-1 rounded hover:bg-rose-50 dark:hover:bg-rose-900/30 text-slate-400 hover:text-rose-500 transition-colors",title:"清除紀錄",children:e.jsx(ae,{size:12})})]}),e.jsx("div",{className:"space-y-2",children:i.length>0?i.slice(0,15).map((l,d)=>e.jsxs("div",{className:k("p-2 rounded-lg border shadow-sm flex items-start gap-2 text-xs",p.SURFACE_CARD,p.BORDER_LIGHT),children:[e.jsx("div",{className:k("mt-0.5 min-w-[3px] h-3 rounded-full",l.score>0?"bg-emerald-400":"bg-rose-400")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[e.jsx("span",{className:k("font-bold truncate mr-2",p.TEXT_PRIMARY),title:l.targetName,children:l.targetName||"未知目標"}),e.jsxs("span",{className:k("text-[10px] flex items-center gap-0.5 whitespace-nowrap",p.TEXT_MUTED),children:[e.jsx(Xt,{size:8}),new Date(l.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:k("flex justify-between items-center px-1.5 py-0.5 rounded",p.TEXT_SECONDARY,"bg-slate-50 dark:bg-slate-700/50"),children:[e.jsx("span",{className:"truncate max-w-[100px]",title:l.behaviorLabel,children:l.behaviorLabel||"評分"}),e.jsxs("span",{className:k("font-mono font-bold",l.score>0?"text-emerald-600 dark:text-emerald-400":"text-rose-600 dark:text-rose-400"),children:[l.score>0?"+":"",l.score]})]})]})]},d)):e.jsx("div",{className:k("text-center text-xs py-4 border-2 border-dashed rounded-lg",p.TEXT_MUTED,p.BORDER_DEFAULT),children:"尚無紀錄"})})]})]})]})},wa=({isOpen:t,onClose:s,activeTab:r,setActiveTab:a,isEditingList:o,setIsEditingList:n,onImportList:i,onStudentClick:l,onDragStart:d,onDrop:x,displayMode:m,appMode:h})=>{const{undo:u,redo:y,canUndo:w,canRedo:b}=be(),[f,j]=N.useState(!1);return t?e.jsxs("div",{className:`${p.SURFACE_MAIN} border-r ${p.BORDER_DEFAULT} flex flex-col shadow-lg z-20 shrink-0 transition-all duration-300 ease-in-out relative no-print ${t?"w-80 translate-x-0":"w-0 -translate-x-full border-r-0 opacity-0 overflow-hidden"}`,children:[e.jsx(Yt,{isOpen:f,onClose:()=>j(!1)}),e.jsxs("div",{className:"w-80 h-full flex flex-col",children:[e.jsxs("div",{className:`flex border-b ${p.BORDER_LIGHT} bg-slate-50 dark:bg-slate-800`,children:[e.jsxs("button",{onClick:()=>a("management"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors ${r==="management"?`${p.SURFACE_MAIN} text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400`:`${p.TEXT_SECONDARY} hover:bg-slate-100 dark:hover:bg-slate-700`}`,children:[e.jsx(le,{size:16})," 班級管理"]}),e.jsxs("button",{onClick:()=>a("scores"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors ${r==="scores"?`${p.SURFACE_MAIN} text-purple-600 dark:text-purple-400 border-b-2 border-purple-600 dark:border-purple-400`:`${p.TEXT_SECONDARY} hover:bg-slate-100 dark:hover:bg-slate-700`}`,children:[e.jsx(js,{size:16})," 分數統計"]}),e.jsx("button",{onClick:s,className:`px-3 ${p.TEXT_MUTED} hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 border-l ${p.BORDER_DEFAULT}`,children:e.jsx(rr,{size:16})})]}),r==="management"?e.jsx(ya,{isEditingList:o,setIsEditingList:n,onImportList:i,onStudentClick:l,onDragStart:d,onDrop:x,onOpenBackup:()=>j(!0),displayMode:m,appMode:h}):e.jsx(ja,{}),e.jsxs("div",{className:`p-4 pl-20 border-t ${p.BORDER_LIGHT} bg-slate-50 dark:bg-slate-800 flex items-center justify-between pb-6`,children:[e.jsx("span",{className:`text-xs font-bold ${p.TEXT_MUTED} whitespace-nowrap`,children:"操作紀錄"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u,disabled:!w,className:`p-2 ${p.BTN_SECONDARY} rounded-lg disabled:opacity-30 disabled:cursor-not-allowed`,title:"復原 (Undo)",children:e.jsx(ds,{size:16})}),e.jsx("button",{onClick:y,disabled:!b,className:`p-2 ${p.BTN_SECONDARY} rounded-lg disabled:opacity-30 disabled:cursor-not-allowed`,title:"重做 (Redo)",children:e.jsx(xr,{size:16})})]})]})]})]}):null};var Na=qt();const Ca=({feedbacks:t,mode:s="celebrate"})=>!t||t.length===0?null:Na.createPortal(e.jsx("div",{className:"fixed inset-0 pointer-events-none z-[9999] overflow-hidden flex items-center justify-center",children:t.map(r=>r.type==="milestone"?e.jsx(Ta,{feedback:r,mode:s},r.id):r.type==="class"||r.type==="group"?e.jsx(Sa,{feedback:r,mode:s},r.id):e.jsx($a,{feedback:r,mode:s},r.id))}),document.body),Sa=({feedback:t,mode:s="celebrate"})=>{const r=s==="calm",a=t.type==="class",o=t.type==="group",n=t.value>0,d=a?"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2":"top-0 left-1/2 -translate-x-1/2 translate-y-[100%]",x=30,m=Wt.useMemo(()=>{const h=["#FFC107","#FF5722","#03A9F4","#4CAF50","#E91E63"];return Array.from({length:x}).map((u,y)=>{const w=Math.random()*Math.PI*2,b=120+Math.random()*220,f=Math.cos(w)*b,j=Math.sin(w)*b-(60+Math.random()*120),c=(Math.random()>.5?1:-1)*(360+Math.random()*720),v=Math.random()*.25,C=6+Math.random()*8,M=h[y%h.length];return{i:y,dx:f,dy:j,rot:c,delay:v,size:C,color:M}})},[x]);return e.jsxs("div",{className:`absolute ${d} ${o?"animate-float-soft":""} flex flex-col items-center justify-center`,children:[a&&n&&!r&&e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none",children:m.map(h=>e.jsx("div",{className:"confetti-piece",style:{backgroundColor:h.color,width:`${h.size}px`,height:`${h.size}px`,animationDelay:`${h.delay}s`,"--dx":`${h.dx}px`,"--dy":`${h.dy}px`,"--rot":`${h.rot}deg`}},h.i))}),e.jsxs("div",{className:"animate-pop-and-vanish relative flex flex-col items-center",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`
                pointer-events-none absolute -inset-2 rounded-[28px]
                opacity-30 blur-[6px]
                ${a?"bg-yellow-400/75":"bg-indigo-400/75"}
              `}),e.jsx("div",{className:`
                pointer-events-none absolute -inset-[1px] rounded-[24px]
                ${a?"ring-2 ring-yellow-300/20":"ring-2 ring-indigo-300/20"}
              `})]}),e.jsxs("div",{className:`
            relative ${a?"px-12 py-6":"px-8 py-4"} rounded-3xl border-4
            shadow-[0_20px_60px_-15px_rgba(0,0,0,0.3)]
            flex items-center gap-6 backdrop-blur-xl
            ${a?"bg-gradient-to-br from-yellow-50/90 to-amber-100/90 border-yellow-400 text-amber-800":"bg-gradient-to-br from-slate-50/90 to-indigo-100/90 border-indigo-400 text-indigo-800"}
          `,children:[e.jsx("div",{className:`
              ${a?"p-4":"p-3"} rounded-full shadow-inner border-2
              ${a?"bg-yellow-200 border-yellow-300":"bg-indigo-200 border-indigo-300"}
            `,children:e.jsx(le,{size:a?48:38})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`${a?"text-2xl":"text-lg"} font-bold opacity-80 uppercase tracking-widest`,children:t.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`${a?"text-6xl":"text-5xl"} font-black ${n?"":"text-slate-500"}`,children:[n?"+":"",t.value]}),n&&e.jsx(ss,{size:a?32:24,className:"animate-spin-slow text-yellow-500 filter drop-shadow"})]})]})]})]})]})},$a=({feedback:t})=>{const s=t.value>0,r=(Math.random()-.5)*40;return e.jsx("div",{className:"absolute flex flex-col items-center justify-center animate-float-up opacity-0 z-50",style:{left:t.x+r,top:t.y,animationDelay:`${t.delay||0}ms`},children:e.jsxs("div",{className:`font-black rounded-full shadow-lg border-2 flex items-center justify-center backdrop-blur-sm ${s?"text-2xl w-12 h-12 border-emerald-200 bg-emerald-100/90 text-emerald-600":"text-2xl w-12 h-12 border-rose-200 bg-rose-100/90 text-rose-600"}`,children:[t.value>0?"+":"",t.value]})})},Ta=({feedback:t,mode:s})=>{const r=t.milestoneType==="group",a=r?"#818cf8":"#fbbf24",o=s==="calm";return e.jsxs("div",{className:"absolute flex flex-col items-center pointer-events-none animate-fade-out-end z-[100]",style:{left:t.x,top:t.y,transform:"translate(-50%, -50%)"},children:[!o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-60 animate-spin-slow pointer-events-none mix-blend-screen",children:e.jsx("div",{className:`${r?"w-[340px] h-[340px]":"w-[280px] h-[280px]"} rounded-full`,style:{background:`conic-gradient(from 0deg, 
                            transparent 0deg, ${a} 15deg, transparent 30deg, 
                            transparent 45deg, ${a} 60deg, transparent 75deg,
                            transparent 90deg, ${a} 105deg, transparent 120deg,
                            transparent 135deg, ${a} 150deg, transparent 165deg,
                            transparent 180deg, ${a} 195deg, transparent 210deg,
                            transparent 225deg, ${a} 240deg, transparent 255deg,
                            transparent 270deg, ${a} 285deg, transparent 300deg,
                            transparent 315deg, ${a} 330deg, transparent 345deg
                          )`,maskImage:"radial-gradient(closest-side, black 40%, transparent 95%)",WebkitMaskImage:"radial-gradient(closest-side, black 40%, transparent 95%)"}})}),e.jsx("div",{className:"absolute inset-0 animate-pulse-slow opacity-50",children:e.jsx("div",{className:`${r?"w-44 h-44":"w-32 h-32"} rounded-full blur-[40px] ${r?"bg-indigo-500":"bg-amber-500"}`})}),e.jsxs("div",{className:"relative animate-bounce-in flex flex-col items-center z-10",children:[e.jsx("div",{className:`
                    p-3 rounded-full border-4 shadow-[0_0_30px_rgba(0,0,0,0.2)] mb-2 bg-white
                    ${r?"border-indigo-300 text-indigo-600":"border-amber-300 text-amber-500"}
                `,children:r?e.jsx(ht,{size:40,fill:"currentColor"}):e.jsx(me,{size:28,fill:"currentColor"})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`${r?"text-6xl":"text-5xl"} font-black text-white text-stroke-2 drop-shadow-2xl tracking-wider font-mono`,children:t.value}),e.jsx("span",{className:"text-sm font-black text-white bg-slate-900/80 px-3 py-1 rounded-full mt-2 border border-white/30 tracking-widest shadow-lg",children:"LEVEL UP!"})]})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full overflow-visible",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 bg-yellow-400 rounded-full animate-particle-1"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 bg-red-400 rounded-full animate-particle-2"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 bg-blue-400 rounded-full animate-particle-3"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 bg-green-400 rounded-full animate-particle-4"})]})]})},Ea=`
@keyframes float-soft {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

.animate-float-soft {
  animation: float-soft 3s ease-in-out infinite;
}
  @keyframes float-up {
    0% { transform: translateY(0) scale(0.5); opacity: 0; }
    20% { transform: translateY(-20px) scale(1.2); opacity: 1; }
    80% { transform: translateY(-60px) scale(1); opacity: 1; }
    100% { transform: translateY(-80px) scale(0.8); opacity: 0; }
  }
  
  @keyframes bounce-in {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.5); opacity: 1; }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
  }

  /* ★ 新增：彈出並優雅消失 (總長 3s) */
	@keyframes pop-and-vanish {
	  0% { transform: scale(0) rotate(-10deg); opacity: 0; }
	  20% { transform: scale(1.1) rotate(2deg); opacity: 1; }
	  30% { transform: scale(1) rotate(0deg); opacity: 1; }
	  70% { transform: scale(1.02); opacity: 1; } /* 微呼吸 */
	  85% { transform: scale(1); opacity: 1; }
	  100% { transform: scale(1.08) translate(0, -20px); opacity: 0; }
	}

  /* ★ 新增：純淡出 (給 Milestone 用) */
  @keyframes fade-out-end {
      0% { opacity: 1; }
      85% { opacity: 1; }
      100% { opacity: 0; }
  }

  @keyframes pulse-slow {
      0% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.5); opacity: 0.8; }
      100% { transform: scale(1); opacity: 0.5; }
  }
  
  @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  /* 粒子動畫 (1.5s 快速消失) */

	
  @keyframes particle-1 { 0% { transform: translate(0,0); opacity: 1;} 100% { transform: translate(-30px, -40px); opacity: 0;} }
  @keyframes particle-2 { 0% { transform: translate(0,0); opacity: 1;} 100% { transform: translate(30px, -40px); opacity: 0;} }
  @keyframes particle-3 { 0% { transform: translate(0,0); opacity: 1;} 100% { transform: translate(-20px, 30px); opacity: 0;} }
  @keyframes particle-4 { 0% { transform: translate(0,0); opacity: 1;} 100% { transform: translate(20px, 30px); opacity: 0;} }

@keyframes confetti-fall {
  0% {
    transform: translate(0, 0) scale(0.8);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
}
  /* Class Mapping */
  .animate-float-up { animation: float-up 1.5s ease-out forwards; }
  .animate-bounce-in { animation: bounce-in 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
  
  /* 設定為 3s，剛好對應 JS 的 setTimeout */
  .animate-pop-and-vanish { animation: pop-and-vanish 3s ease-in-out forwards; }
  .animate-fade-out-end { animation: fade-out-end 3s linear forwards; }
  
  .animate-pulse-slow { animation: pulse-slow 2s ease-in-out infinite; }
  .animate-spin-slow { animation: spin-slow 10s linear infinite; }
  
  .animate-particle-1 { animation: particle-1 0.8s ease-out forwards; }
  .animate-particle-2 { animation: particle-2 0.8s ease-out forwards; }
  .animate-particle-3 { animation: particle-3 0.8s ease-out forwards; }
  .animate-particle-4 { animation: particle-4 0.8s ease-out forwards; }
  
  .text-stroke-2 { -webkit-text-stroke: 1.5px rgba(0,0,0,0.3); }
  
  /* confetti：通用爆開（每片吃 --dx/--dy/--rot） */
.confetti-piece {
  position: absolute;
  left: 0;
  top: 0;
  border-radius: 2px;
  opacity: 0;
  animation: confetti-burst 1.6s ease-out forwards;
  will-change: transform, opacity;
}

@keyframes confetti-burst {
  0%   { opacity: 0; transform: translate(0, 0) rotate(0) scale(0.9); }
  8%   { opacity: 1; }
  100% { opacity: 0; transform: translate(var(--dx), var(--dy)) rotate(var(--rot)) scale(1); }
}

  
`,it="score-feedback-styles";if(typeof document<"u"&&!document.getElementById(it)){const t=document.createElement("style");t.id=it,t.innerText=Ea,document.head.appendChild(t)}const Ma=({groupScores:t={},students:s=[],isVisible:r,onClose:a,onQuickScore:o,onDetailScore:n,onClassScore:i,batchScoreMode:l,onToggleBatchMode:d})=>{if(!r)return null;const x=new Set;Object.keys(t).forEach(u=>x.add(u)),s.forEach(u=>{u.group&&u.group.trim()!==""&&x.add(u.group)});const m=Array.from(x).map(u=>({groupId:u,score:t[u]||0})).sort((u,y)=>{const w=parseInt(u.groupId),b=parseInt(y.groupId);return!isNaN(w)&&!isNaN(b)?w-b:u.groupId.localeCompare(y.groupId)}),h=Math.max(...m.map(u=>u.score),0);return e.jsxs("div",{className:k("absolute right-0 top-14 md:top-16 bottom-0 w-44 md:w-52","bg-white/95 dark:bg-slate-900/95 backdrop-blur-md","border-l border-slate-200 dark:border-slate-700 shadow-2xl z-[40]","flex flex-col transition-all duration-300 animate-in slide-in-from-right"),children:[e.jsxs("div",{className:"p-3 border-b border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50 flex flex-col gap-2 shrink-0 relative",children:[e.jsx("button",{onClick:a,className:"absolute top-2 right-2 p-1.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",title:"隱藏評分工具",children:e.jsx(ee,{size:16})}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-200 font-bold pr-6",children:[e.jsx(me,{size:16,className:"text-amber-500"}),e.jsx("span",{className:"text-[16px] font-bold text-slate-600 dark:text-slate-200",children:"評分工具"})]}),e.jsxs("button",{onClick:i,className:k("w-full py-2 px-3 rounded-lg flex items-center justify-center gap-2 mt-1","bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-black text-lg","shadow-md shadow-indigo-200 dark:shadow-none","hover:shadow-lg hover:scale-[1.02] active:scale-95 transition-all"),children:[e.jsx(Ls,{size:16,className:"animate-pulse"}),"全班加分"]}),e.jsxs("div",{className:"mt-1 pt-2 border-t border-slate-200/60 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5 px-0.5",children:[e.jsxs("span",{className:"text-[12px] font-bold text-slate-400 dark:text-slate-500 flex items-center gap-1",children:[e.jsx(Ks,{size:14})," 快速評分模式"]}),l&&e.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 animate-pulse",children:l==="add"?"加分中...":"扣分中..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d&&d("add"),className:k("flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-xs font-bold transition-all border-b-2 active:border-b-0 active:translate-y-[2px]",l==="add"?"bg-emerald-500 text-white border-emerald-700 shadow-inner":"bg-emerald-50 dark:bg-emerald-700/50 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-900 hover:bg-emerald-100 dark:hover:bg-emerald-500 dark:hover:text-white"),title:"啟動後，點擊學生直接 +1 分",children:e.jsx(xe,{size:18,strokeWidth:3})}),e.jsx("button",{onClick:()=>d&&d("deduct"),className:k("flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-xs font-bold transition-all border-b-2 active:border-b-0 active:translate-y-[2px]",l==="deduct"?"bg-rose-500 text-white border-rose-700 shadow-inner":"bg-rose-50 dark:bg-rose-700/50 text-rose-600 dark:text-rose-100 border-rose-200 dark:border-rose-900 hover:bg-rose-100 dark:hover:bg-rose-500 dark:hover:text-white"),title:"啟動後，點擊學生直接 -1 分",children:e.jsx(Qe,{size:18,strokeWidth:3})})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-2 custom-scrollbar",children:[e.jsxs("div",{className:"px-1 py-1 text-[10px] font-bold text-slate-400 uppercase tracking-wider flex items-center gap-1",children:[e.jsx(gt,{size:12})," 小組列表"]}),m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center text-xs text-slate-400 opacity-60",children:[e.jsx(le,{size:32,className:"mb-2 text-slate-300"}),e.jsx("p",{children:"尚無小組資料"}),e.jsx("p",{className:"mt-1 text-[10px]",children:"請先在側邊欄設定學生組別"})]}):m.map(u=>{const y=u.score===h&&u.score>0,w=parseInt(u.groupId)||0,b=re[w%9]||re[0];return e.jsxs("div",{className:k("relative p-2 rounded-xl border transition-all duration-300 group",y?"bg-amber-50/50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700 shadow-sm":"bg-white dark:bg-slate-800 border-slate-100 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-500 hover:shadow-sm"),children:[y&&e.jsx("div",{className:"absolute -top-1.5 -left-1.5",children:e.jsx("div",{className:"bg-amber-100 dark:bg-amber-800 text-amber-600 dark:text-amber-200 p-1 rounded-full shadow-sm border border-white dark:border-slate-700 animate-bounce-slight",children:e.jsx(ht,{size:12,fill:"currentColor"})})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("button",{onClick:()=>n(u.groupId),className:"flex items-center gap-3 flex-1 text-left min-w-0",children:[e.jsx("div",{className:k("w-8 h-8 rounded-lg flex items-center justify-center text-sm font-black shadow-sm shrink-0 border",b.bg,b.text,b.border),children:u.groupId}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-[14px] text-slate-400 dark:text-slate-500 font-bold uppercase tracking-wider",children:["第 ",u.groupId," 組"]}),e.jsx("span",{className:k("text-lg font-black leading-none",y?"text-amber-600 dark:text-amber-400":"text-slate-700 dark:text-slate-200"),children:u.score})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>o(u.groupId,1),className:"w-8 h-7 flex items-center justify-center rounded-lg bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 border border-emerald-100 dark:border-emerald-800 hover:bg-emerald-500 hover:text-white hover:border-emerald-500 transition-all active:scale-90 shadow-sm",children:e.jsx(xe,{size:16,strokeWidth:3})}),e.jsx("button",{onClick:()=>o(u.groupId,-1),className:"w-8 h-6 flex items-center justify-center rounded-lg bg-rose-50 dark:bg-rose-700/50 text-rose-400 dark:text-rose-400 border border-slate-100 dark:border-slate-600 hover:bg-rose-500 hover:text-white hover:border-rose-200 transition-all active:scale-90",children:e.jsx(Qe,{size:14,strokeWidth:3})})]})]})]},u.groupId)}),e.jsx("div",{className:"h-16"})]}),e.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }
        @keyframes bounce-slight {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(0, -3px); }
        }
        .animate-bounce-slight {
            animation: bounce-slight 2s infinite ease-in-out;
        }
      `})]})},za=(t,s)=>{if(t.isDragTarget!==s.isDragTarget||t.onStudentClick!==s.onStudentClick||t.isVoid!==s.isVoid||t.displayMode!==s.displayMode||t.mode!==s.mode||t.hoveredGroup!==s.hoveredGroup)return!1;const r=t.student,a=s.student;return!r||!a?r===a:r.id===a.id&&r.name===a.name&&r.score===a.score&&r.group===a.group&&r.gender===a.gender&&r.locked===a.locked&&t.attendanceStatus?.[r.id]===s.attendanceStatus?.[a.id]},_a=({row:t,col:s,student:r,onDrop:a,onDragStart:o,onStudentClick:n,displayMode:i="normal",mode:l="arrange",attendanceStatus:d={},isVoid:x,onToggleVoid:m,onToggleLock:h,hoveredGroup:u,isCompact:y=!1,layoutRows:w,isDragTarget:b,onCellDragOver:f,onCellDragLeave:j})=>{const[c,v]=N.useState(!1),C=N.useRef(r?.score||0),M=r&&d[r.id]?d[r.id]:"present",g=qe[M]||qe.present;N.useEffect(()=>{r&&(r.score<C.current&&(v(!0),setTimeout(()=>v(!1),400)),C.current=r.score)},[r?.score]);const _=$=>{l==="arrange"&&($.preventDefault(),m(t,s))},E=$=>{$.preventDefault(),f&&f($,t,s)},z=$=>{j&&j($)},D=$=>{$.preventDefault(),j&&j($);const U=$.dataTransfer.getData("studentId"),se=$.dataTransfer.getData("sourceSeat");U&&a(U,t,s,se||null)},S=(($,U)=>U?"min-h-[36px]":$<=5?"min-h-[100px] md:min-h-[120x]":$<=6?"min-h-[80px] md:min-h-[86px]":$<=7?"min-h-[50px] md:min-h-[80px]":"min-h-[50px] md:min-h-[64px]")(w,y),F=r?.name?.length||0;let L=(($,U)=>$<=5?U>3?"text-2xl":"text-3xl":$<=6?U>3?"text-xl":"text-2xl":$<=7?U>3?"text-lg":"text-xl":U>3?"text-sm":"text-base md:text-lg")(w,F);if(x)return e.jsx("div",{onContextMenu:_,className:k("w-full transition-colors duration-200",S,l==="arrange"?"bg-slate-100/50 border border-dashed border-slate-200 cursor-cell hover:bg-slate-200/50 relative group":"opacity-0 pointer-events-none"),children:l==="arrange"&&e.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[14px] text-slate-300 opacity-0 group-hover:opacity-100 select-none",children:"右鍵復原"})});if(!r)return e.jsx("div",{onContextMenu:_,onDragOver:E,onDragLeave:z,onDrop:D,className:k("w-full transition-all flex items-center justify-center",S,l==="arrange"&&["rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-300","bg-slate-50/50 dark:bg-slate-600 text-slate-300 dark:text-white","hover:bg-slate-100 hover:dark:bg-slate-800 hover:border-slate-300 cursor-cell"],b&&l==="arrange"&&"ring-4 ring-yellow-400 bg-yellow-50/50 dark:bg-yellow-900/30 z-20 scale-105 border-yellow-400"),title:l==="arrange"?"右鍵設為走道":"",children:l==="arrange"&&e.jsx("span",{className:"text-base font-bold",children:"空"})});let V="bg-white dark:bg-slate-900/80",G="border-slate-700 dark:border-slate-200 border-b-[3px]",te="text-slate-700 dark:text-slate-200";if(i==="gender"){const $=ce[r.gender]||ce.M;V=$.bg,G=`${$.border} border-b-[3px]`,te=$.text}else if(i==="group"){const U=(parseInt(r.group)||0)%9;G=`${(re[U]||re[0]).border} border-b-[4px]`}M!=="present"&&M!=="late"&&(V=g.bg,te=g.color,G=g.border);const ne=u&&String(r.group)===String(u),q=r.locked,J=M==="absent"||M==="personal";return e.jsxs("div",{id:`student-card-${r.id}`,onContextMenu:_,draggable:l==="arrange"&&!q,onDragStart:$=>{l==="arrange"&&!q&&o($,r.id)},onDragOver:E,onDragLeave:z,onDrop:D,onClick:()=>{l==="arrange"&&q?h(r.id):n(r)},className:k("relative w-full rounded-xl border shadow-sm transition-all duration-200","flex flex-col items-center justify-center select-none overflow-hidden",S,V,G,te,M==="present"&&"hover:shadow-md hover:-translate-y-0.5",l==="arrange"&&!q?"cursor-grab active:cursor-grabbing":"cursor-pointer",c&&"animate-shake ring-2 ring-rose-400",ne&&"ring-4 ring-yellow-400 scale-105 z-20 shadow-xl",b&&l==="arrange"&&"ring-4 ring-blue-400 dark:ring-blue-500 scale-105 z-20 shadow-xl opacity-90"),title:l==="arrange"?"右鍵設為走道":"",children:[e.jsx("div",{className:k("absolute top-1 left-2 px-1.5 pt-0.5 pb-1 rounded-br-lg backdrop-blur-sm","text-[12px] md:text-base font-black font-mono leading-none z-10",J?"text-white/70":"text-slate-700 dark:text-white"),children:r.number}),!J&&r.score!==0&&r.score!==void 0&&e.jsxs("div",{className:k("absolute bottom-1 left-1 px-1 py-0.5 rounded-full md:text-sm font-black shadow-sm z-10",r.score>0?"bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300 border border-amber-200 dark:border-amber-700":"bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300 border border-rose-200 dark:border-rose-700"),children:[r.score>0?"+":"",r.score]}),l==="arrange"&&e.jsx("div",{className:"absolute top-0 right-1 z-10",children:e.jsx("button",{onMouseDown:$=>$.stopPropagation(),onClick:$=>{$.stopPropagation(),h(r.id)},className:k("p-1 rounded-full transition-colors",q?"text-slate-500 bg-slate-50 dark:bg-slate-900/30":"text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700"),children:q?e.jsx(kt,{size:12,fill:"currentColor"}):e.jsx(ft,{size:12})})}),!y&&r.group&&i!=="group"&&e.jsx("div",{className:"absolute bottom-1 right-1 opacity-30 z-0",children:e.jsxs("span",{className:"md:text-sm font-bold flex items-center gap-0.5",children:[e.jsx(Ra,{size:10}),r.group]})}),e.jsxs("div",{className:"w-full px-1 flex flex-col items-center justify-center z-0",children:[e.jsx("span",{className:k("font-bold leading-tight text-center line-clamp-2",L),children:r.name}),M!=="present"&&M!=="late"&&e.jsxs("span",{className:k("mt-0.5 px-1.5 py-0.5 rounded text-[10px] font-bold flex items-center gap-1 shadow-sm","bg-white/20 backdrop-blur-sm border border-white/10 text-current"),children:[g.icon," ",g.label]})]}),i==="gender"&&e.jsx("div",{className:k("absolute bottom-0 right-0 w-8 h-8 rounded-tl-3xl opacity-20 pointer-events-none",ce[r.gender]?.decoration||ce.M.decoration)})]})},Ra=({size:t=12})=>e.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Da=N.memo(_a,za),_t=N.memo(({layout:t,students:s,isTeacherView:r,onSeatDrop:a,onStudentClick:o,displayMode:n,appMode:i,attendanceStatus:l,onToggleVoid:d,onToggleLock:x,hoveredGroup:m})=>{const[h,u]=N.useState(null),y=N.useCallback((_,E,z)=>{_.preventDefault(),u(D=>D?.r===E&&D?.c===z?D:{r:E,c:z})},[]),w=N.useCallback(()=>{u(null)},[]);if(!t)return null;const{rows:b,cols:f,seats:j,voidSeats:c,doorSide:v}=t,C=Array.from({length:f},(_,E)=>E);r&&C.reverse();const g=(r?v==="left":v==="right")?"-right-8 md:-right-12 rounded-l-xl border-l-4":"-left-8 md:-left-12 rounded-r-xl border-r-4";return e.jsxs("div",{className:"relative w-full max-w-5xl mx-auto flex-1 flex flex-col transition-all duration-300",children:[e.jsx("div",{className:`absolute w-6 h-24 bg-amber-200 dark:bg-amber-900/80 border-amber-300 dark:border-amber-700 flex items-center justify-center text-amber-800 dark:text-amber-200 font-bold text-[16px] writing-vertical ${g} top-12 transition-colors z-10 shadow-md`,children:e.jsx("span",{className:"tracking-widest",children:r?"後門":"前門"})}),e.jsx("div",{className:`absolute w-6 h-24 bg-amber-200 dark:bg-amber-900/80 border-amber-300 dark:border-amber-700 flex items-center justify-center text-amber-800 dark:text-amber-200 font-bold text-[16px] writing-vertical ${g} bottom-12 transition-colors z-10 shadow-md`,children:e.jsx("span",{className:"tracking-widest",children:r?"前門":"後門"})}),e.jsx("div",{className:"flex-1 w-full min-h-0 grid gap-2",children:C.map(_=>e.jsx("div",{className:"grid gap-2 h-full",style:{gridTemplateColumns:`repeat(${b}, minmax(0, 1fr))`},children:Array.from({length:b},(E,z)=>{const D=r?b-1-z:z,A=`${_}-${D}`,S=s.find(O=>O.id===j[A]),F=h?.r===_&&h?.c===D;return e.jsx(Da,{row:_,col:D,student:S,onDrop:a,onDragStart:(O,L)=>{O.dataTransfer.setData("studentId",L),O.dataTransfer.setData("sourceSeat",A)},onStudentClick:o,displayMode:n,mode:i,attendanceStatus:l,isVoid:c?.includes(A),onToggleVoid:d,onToggleLock:x,hoveredGroup:m,layoutRows:f,isDragTarget:F,onCellDragOver:y,onCellDragLeave:w},A)})},_))})]})});_t.displayName="SeatGrid";const Ia=({isOpen:t,onClose:s,currentLayout:r,onApplyTemplate:a,onSaveTemplate:o,templates:n,onDeleteTemplate:i,onShowDialog:l})=>{const[d,x]=N.useState("");if(!t)return null;const m=()=>{d.trim()&&(o(d),x(""))};return e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh] border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 bg-slate-800 dark:bg-slate-950 border-b border-slate-700 flex justify-between items-center text-white",children:[e.jsxs("h3",{className:"font-bold text-xl flex items-center gap-2",children:[e.jsx(Ws,{size:24,className:"text-blue-400"})," 座位樣板管理"]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-700 rounded-full text-slate-300",children:e.jsx(ee,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50 dark:bg-slate-800",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-500 dark:text-slate-400 mb-2 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(mt,{size:16})," 儲存目前配置"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:d,onChange:h=>x(h.target.value),placeholder:"輸入樣板名稱 (例如: 英文課分組)",className:"flex-1 p-2 border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-lg text-sm outline-none focus:border-blue-500"}),e.jsx("button",{onClick:m,disabled:!d.trim(),className:"px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"儲存"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(pt,{size:16})," 選擇樣板套用"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:n.map(h=>e.jsxs("div",{className:"bg-white dark:bg-slate-700 p-4 rounded-xl border border-slate-200 dark:border-slate-600 hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition-all group relative",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h5",{className:"font-bold text-slate-800 dark:text-white",children:h.name}),h.type==="custom"&&e.jsx("button",{onClick:u=>{u.stopPropagation(),l({type:"confirm",title:"刪除樣板",message:"確定刪除此樣板？",variant:"danger",onConfirm:()=>i(h.id)})},className:"text-slate-300 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-400 p-1 transition-colors",children:e.jsx(ae,{size:14})})]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:h.description||(h.type==="preset"?"系統預設":"自訂樣板")}),e.jsx("button",{onClick:()=>{l({type:"confirm",title:"套用樣板",message:`確定套用「${h.name}」嗎？
這將會改變目前的教室尺寸與走道設定。
(學生將會保留，若位置不足會移至未排區)`,onConfirm:()=>{a(h),s()}})},className:k("w-full py-2 bg-slate-100 dark:bg-slate-600 rounded-lg text-sm font-bold transition-colors","hover:bg-blue-50 dark:hover:bg-slate-500","text-slate-600 dark:text-slate-200 hover:text-blue-600 dark:hover:text-white"),children:"套用此樣板"})]},h.id))})]})]})]})})},Ie=(t,s)=>{const r={};return t.forEach((a,o)=>{const n=(o+1).toString();a.forEach(i=>{r[i.id]=n})}),s.map(a=>({...a,group:r[a.id]!==void 0?r[a.id]:""}))},Aa=(t,s)=>[...t].sort(()=>Math.random()-.5).map((a,o)=>({...a,group:(o%s+1).toString()})),La=(t,s)=>{const r=t.filter(l=>l.gender==="M").sort(()=>Math.random()-.5),a=t.filter(l=>l.gender==="F").sort(()=>Math.random()-.5),o=t.filter(l=>l.gender!=="M"&&l.gender!=="F").sort(()=>Math.random()-.5),n=Array.from({length:s},()=>[]),i=l=>{let d=0,x=1;l.forEach(m=>{n[d].push(m),x===1?d===s-1?x=-1:d++:d===0?x=1:d--})};return i(r),i(a),i(o),Ie(n,t)},Oa=(t,s)=>{const r=[...t].sort((i,l)=>(parseFloat(l.performance)||0)-(parseFloat(i.performance)||0)),a=Array.from({length:s},()=>[]);let o=0,n=1;return r.forEach(i=>{a[o].push(i),n===1?o===s-1?n=-1:o++:o===0?n=1:o--}),Ie(a,t)},Pa=(t,s)=>{const r=(d,x)=>(parseFloat(x.performance)||0)-(parseFloat(d.performance)||0),a=t.filter(d=>d.gender==="M").sort(r),o=t.filter(d=>d.gender==="F").sort(r),n=t.filter(d=>d.gender!=="M"&&d.gender!=="F").sort(r),i=Array.from({length:s},()=>[]),l=(d,x=1)=>{let m=x===1?0:s-1,h=x;d.forEach(u=>{i[m].push(u),h===1?m===s-1?h=-1:m++:m===0?h=1:m--})};return l(a,1),l(o,-1),l(n,1),Ie(i,t)},Fa=({isOpen:t,onClose:s,students:r,onUpdateStudents:a,onShowDialog:o})=>{const[n,i]=N.useState([]),[l,d]=N.useState(6),[x,m]=N.useState("filled");if(N.useEffect(()=>{if(t){i(JSON.parse(JSON.stringify(r)));const g=Math.max(...r.map(_=>parseInt(_.group)||0),0);g>0&&d(g)}},[t,r]),!t)return null;const h=n.some(g=>g.performance!==void 0&&g.performance!==null),u=()=>i(Aa(n,l)),y=()=>i(La(n,l)),w=()=>i(Oa(n,l)),b=()=>i(Pa(n,l)),f=()=>{o({type:"confirm",title:"清除分組",message:`確定要清除所有分組設定嗎？
學生將回到未分組狀態。`,variant:"warning",confirmText:"清除",onConfirm:()=>{i(g=>g.map(_=>({..._,group:""})))}})},j=()=>{a(n),s()},c=(g,_)=>{g.dataTransfer.setData("studentId",_),g.dataTransfer.effectAllowed="move"},v=(g,_)=>{g.preventDefault();const E=g.dataTransfer.getData("studentId");E&&i(z=>z.map(D=>D.id===E?{...D,group:_}:D))},C=g=>{g.preventDefault(),g.dataTransfer.dropEffect="move"},M={unassigned:[]};for(let g=1;g<=l;g++)M[g.toString()]=[];return n.forEach(g=>{const _=g.group&&M[g.group]?g.group:"unassigned";M[_].push(g)}),e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-7xl h-[90vh] flex flex-col overflow-hidden border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 bg-slate-800 dark:bg-slate-950 text-white flex justify-between items-center shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(bt,{size:24,className:"text-purple-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"分組管理看板"}),e.jsx("p",{className:"text-xs text-slate-400",children:"請從左側名單拖曳學生至右側組別，或使用自動分配"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-6 w-px bg-slate-600 mx-2"}),e.jsxs("div",{className:"flex items-center bg-slate-700 rounded-lg p-1",children:[e.jsx("span",{className:"text-xs font-bold px-2 text-slate-300",children:"組數:"}),e.jsx("button",{onClick:()=>d(g=>Math.max(2,g-1)),className:"w-6 h-6 flex items-center justify-center bg-slate-600 hover:bg-slate-500 rounded text-white font-bold",children:"-"}),e.jsx("span",{className:"w-8 text-center font-mono font-bold",children:l}),e.jsx("button",{onClick:()=>d(g=>Math.min(12,g+1)),className:"w-6 h-6 flex items-center justify-center bg-slate-600 hover:bg-slate-500 rounded text-white font-bold",children:"+"})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-700 rounded-full text-slate-400 hover:text-white transition-colors",children:e.jsx(ee,{size:20})})]})]}),e.jsxs("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex flex-wrap gap-2 shrink-0 items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 dark:text-slate-500 uppercase mr-1",children:"自動分配："}),e.jsxs("button",{onClick:u,className:"px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-purple-50 dark:hover:bg-purple-900/30 hover:text-purple-600 dark:hover:text-purple-300 transition-all shadow-sm",children:[e.jsx(ct,{size:16})," 純隨機"]}),e.jsxs("button",{onClick:y,className:"px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-blue-50 dark:hover:bg-blue-900/30 hover:text-blue-600 dark:hover:text-blue-300 transition-all shadow-sm",children:[e.jsx(le,{size:16})," 性別平均"]}),e.jsx("div",{className:"h-6 w-px bg-slate-300 dark:bg-slate-600 mx-1"}),e.jsxs("button",{onClick:w,disabled:!h,className:k("px-3 py-2 border rounded-lg text-sm font-bold flex items-center gap-2 transition-all shadow-sm",h?"bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 hover:text-emerald-600 dark:hover:text-emerald-300":"bg-slate-50 dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-600 cursor-not-allowed"),children:[e.jsx(fe,{size:16})," 成績平均"]}),e.jsxs("button",{onClick:b,disabled:!h,className:k("px-3 py-2 border rounded-lg text-sm font-bold flex items-center gap-2 transition-all shadow-sm",h?"bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-amber-50 dark:hover:bg-amber-900/30 hover:text-amber-600 dark:hover:text-amber-300":"bg-slate-50 dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-600 cursor-not-allowed"),children:[e.jsx(hr,{size:16})," 性別+成績平均"]}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{onClick:f,className:"px-3 py-2 bg-white dark:bg-slate-700 border border-red-200 dark:border-red-900/50 text-red-600 dark:text-red-400 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-red-50 dark:hover:bg-red-900/30 transition-all shadow-sm",children:[e.jsx(ae,{size:16})," 清空"]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden bg-slate-200/50 dark:bg-slate-950/50",children:[e.jsxs("div",{className:"w-64 bg-slate-50 dark:bg-slate-900 border-r border-slate-200 dark:border-slate-700 flex flex-col shrink-0",onDragOver:C,onDrop:g=>v(g,""),children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow-sm flex justify-between items-center",children:[e.jsxs("h4",{className:"font-bold text-slate-600 dark:text-slate-300 flex items-center gap-2",children:[e.jsx(le,{size:16})," 未分組名單"]}),e.jsx("span",{className:"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 px-2 py-0.5 rounded-full text-xs font-bold",children:M.unassigned.length})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:[M.unassigned.map(g=>e.jsx(dt,{student:g,onDragStart:c,showPerformance:h},g.id)),M.unassigned.length===0&&e.jsx("div",{className:"py-10 text-center text-slate-400 dark:text-slate-600 text-xs italic border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-lg",children:"全數已分配"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-10",children:Array.from({length:l}).map((g,_)=>{const E=(_+1).toString(),z=M[E],D=z.length,A=z.filter(L=>L.gender==="M").length,S=z.filter(L=>L.gender==="F").length;let F=0;if(h&&D>0){const L=z.reduce((V,G)=>V+(parseFloat(G.performance)||0),0);F=Math.round(L/D)}const O=re[(_+1)%9]||re[0];return e.jsxs("div",{className:k("flex flex-col bg-white dark:bg-slate-800 rounded-xl shadow-sm border-2 min-h-[200px] transition-colors",O.border),onDragOver:C,onDrop:L=>v(L,E),children:[e.jsxs("div",{className:k("p-3 border-b-2 rounded-t-lg flex justify-between items-start",O.bg,O.border),children:[e.jsxs("div",{children:[e.jsxs("h4",{className:k("font-black text-lg",O.text),children:["第 ",E," 組"]}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("div",{className:"flex gap-2 text-[10px] font-bold text-slate-500 dark:text-slate-400",children:[e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-400"}),A]}),e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-rose-400"}),S]})]}),h&&e.jsxs("div",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-400 flex items-center gap-1",children:[e.jsx(fe,{size:10})," Avg: ",F]})]})]}),e.jsxs("span",{className:"bg-white/80 dark:bg-slate-700/80 text-slate-700 dark:text-slate-200 px-2 py-1 rounded-lg text-sm font-black shadow-sm",children:[D,"人"]})]}),e.jsxs("div",{className:k("flex-1 p-2 space-y-2",x==="filled"?"bg-transparent":"bg-slate-50/50 dark:bg-slate-900/30"),children:[z.map(L=>e.jsx(dt,{student:L,onDragStart:c,showPerformance:h},L.id)),z.length===0&&e.jsx("div",{className:"h-24 flex items-center justify-center text-slate-300 dark:text-slate-600 text-xs border-2 border-dashed border-slate-100 dark:border-slate-700 rounded-lg",children:"拖曳至此"})]})]},E)})})})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex justify-end gap-3 shrink-0 z-20",children:[e.jsx("button",{onClick:s,className:"px-6 py-2.5 rounded-xl font-bold text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:"取消"}),e.jsx("button",{onClick:j,className:"px-8 py-2.5 bg-slate-800 dark:bg-slate-700 text-white rounded-xl font-bold hover:bg-slate-700 dark:hover:bg-slate-600 shadow-lg hover:shadow-xl transition-all active:scale-95",children:"儲存分組設定"})]})]})})},dt=({student:t,onDragStart:s,showPerformance:r})=>e.jsxs("div",{draggable:!0,onDragStart:a=>s(a,t.id),className:k("bg-white dark:bg-slate-800 p-2 rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm transition-all flex items-center gap-3 group","cursor-grab active:cursor-grabbing hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md"),children:[e.jsx("div",{className:"text-slate-300 dark:text-slate-600 group-hover:text-blue-400 cursor-grab",children:e.jsx(Fs,{size:14})}),e.jsx("div",{className:k("w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white shrink-0",t.gender==="M"?"bg-blue-400":"bg-rose-400"),children:t.number}),e.jsxs("div",{className:"flex-1 min-w-0 flex justify-between items-center",children:[e.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-200 truncate text-sm",children:t.name}),r&&t.performance!==void 0&&e.jsx("span",{className:"text-[10px] font-mono text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-700 px-1.5 py-0.5 rounded font-bold",children:t.performance})]})]}),Ua=["👍","⭐","❤️","🔥","💡","🎓","🏆","🚀","⚡","📝","🤝","🗣️","💤","❌","⚠️","🐢","📱","🔊"],Ga=({isOpen:t,onClose:s,behaviors:r=[],onUpdateBehaviors:a,onResetScores:o,onShowDialog:n})=>{const[i,l]=N.useState(null),[d,x]=N.useState({icon:"⭐",label:"",score:1,type:"positive"});if(!t)return null;const m=r.filter(c=>c.score>=0||c.type==="positive"),h=r.filter(c=>c.score<0||c.type==="negative"),u=c=>{l(c.id),x({...c})},y=c=>{l("new"),x({id:`b_${Date.now()}`,icon:c==="positive"?"⭐":"⚠️",label:"",score:c==="positive"?1:-1,type:c})},w=()=>{if(!d.label.trim()){n({type:"alert",title:"格式錯誤",message:"請輸入項目名稱",variant:"warning"});return}let c=[...r];if(i==="new")if(d.type==="positive"){const v=c.map(C=>C.score>=0||C.type==="positive").lastIndexOf(!0);v!==-1?c.splice(v+1,0,d):c.unshift(d)}else c.push(d);else c=c.map(v=>v.id===i?d:v);a(c),l(null)},b=c=>{n({type:"confirm",title:"刪除項目",message:"確定要刪除此評分項目嗎？",variant:"danger",onConfirm:()=>{const v=r.filter(C=>C.id!==c);a(v),i===c&&l(null)}})},f=(c,v,C)=>{c.stopPropagation();const M=v.score>=0||v.type==="positive",g=M?[...m]:[...h],_=M?[...h]:[...m],E=g.findIndex(D=>D.id===v.id);if(E===-1)return;if(C==="up"){if(E===0)return;[g[E],g[E-1]]=[g[E-1],g[E]]}else{if(E===g.length-1)return;[g[E],g[E+1]]=[g[E+1],g[E]]}const z=M?[...g,..._]:[..._,...g];a(z)},j=()=>{l(null)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[85vh] relative border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 bg-slate-800 dark:bg-slate-950 flex justify-between items-center text-white shrink-0",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(cs,{size:20,className:"text-slate-400"})," 評分項目設定"]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-white/20 rounded-full text-slate-300",children:e.jsx(ee,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50 dark:bg-slate-800",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-600 dark:text-slate-300 flex items-center gap-2",children:[e.jsx(fr,{className:"text-emerald-500"})," 加分項目"]}),e.jsx("button",{onClick:()=>y("positive"),className:"p-1.5 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-full hover:bg-emerald-200 dark:hover:bg-emerald-900/50 transition-colors",children:e.jsx(xe,{size:16})})]}),e.jsxs("div",{className:"space-y-2",children:[m.map((c,v)=>e.jsxs("div",{onClick:()=>u(c),className:"group flex items-center justify-between p-3 bg-white dark:bg-slate-700 border border-emerald-100 dark:border-emerald-900/50 rounded-xl shadow-sm cursor-pointer hover:border-emerald-300 dark:hover:border-emerald-500 hover:shadow-md transition-all active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:c.icon}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:c.label})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-black text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/30 px-2 py-1 rounded-lg text-based",children:["+",c.score]}),e.jsxs("div",{className:"flex flex-col gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:C=>f(C,c,"up"),disabled:v===0,className:"p-0.5 hover:bg-slate-100 dark:hover:bg-slate-600 rounded text-slate-100 hover:text-slate-600 hover:dark:text-white disabled:opacity-0",children:e.jsx(Je,{size:12})}),e.jsx("button",{onClick:C=>f(C,c,"down"),disabled:v===m.length-1,className:"p-0.5 hover:bg-slate-100 dark:hover:bg-slate-600 rounded text-slate-100 hover:text-slate-600 dark:hover:text-white disabled:opacity-0",children:e.jsx(Ke,{size:12})})]})]})]},c.id)),m.length===0&&e.jsx("div",{className:"text-center py-4 text-xs text-slate-400 border-2 border-dashed border-emerald-100 dark:border-emerald-900/30 rounded-xl",children:"尚無項目"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-600 dark:text-slate-300 flex items-center gap-2",children:[e.jsx(Is,{className:"text-rose-500"})," 扣分項目"]}),e.jsx("button",{onClick:()=>y("negative"),className:"p-1.5 bg-rose-100 dark:bg-rose-900/30 text-rose-700 dark:text-rose-400 rounded-full hover:bg-rose-200 dark:hover:bg-rose-900/50 transition-colors",children:e.jsx(xe,{size:16})})]}),e.jsxs("div",{className:"space-y-2",children:[h.map((c,v)=>e.jsxs("div",{onClick:()=>u(c),className:"group flex items-center justify-between p-3 bg-white dark:bg-slate-700 border border-rose-100 dark:border-rose-900/50 rounded-xl shadow-sm cursor-pointer hover:border-rose-300 dark:hover:border-rose-500 hover:shadow-md transition-all active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl grayscale opacity-80 group-hover:grayscale-0 group-hover:opacity-100 transition-all",children:c.icon}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:c.label})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-black text-rose-600 dark:text-rose-100 bg-rose-50 dark:bg-rose-700/50 px-2 py-1 rounded-lg text-base",children:c.score}),e.jsxs("div",{className:"flex flex-col gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:C=>f(C,c,"up"),disabled:v===0,className:"p-0.5 hover:bg-slate-100 dark:hover:bg-slate-600 rounded text-slate-400 hover:text-slate-600 dark:hover:text-white disabled:opacity-0",children:e.jsx(Je,{size:12})}),e.jsx("button",{onClick:C=>f(C,c,"down"),disabled:v===h.length-1,className:"p-0.5 hover:bg-slate-100 dark:hover:bg-slate-600 rounded text-slate-400 hover:text-slate-600 dark:hover:text-white disabled:opacity-0",children:e.jsx(Ke,{size:12})})]})]})]},c.id)),h.length===0&&e.jsx("div",{className:"text-center py-4 text-xs text-slate-400 border-2 border-dashed border-rose-100 dark:border-rose-900/30 rounded-xl",children:"尚無項目"})]})]})]})}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center shrink-0",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 dark:text-slate-500",children:"系統操作"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>n({type:"confirm",title:"歸零個人分數",message:"確定要歸零所有學生的分數嗎？此操作無法復原。",variant:"danger",onConfirm:()=>o("student")}),className:"px-3 py-1.5 text-xs font-bold text-slate-500 dark:text-slate-400 hover:text-rose-600 dark:hover:text-rose-400 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors border border-transparent hover:border-rose-200 dark:hover:border-rose-800",children:"歸零個人分數"}),e.jsx("button",{onClick:()=>n({type:"confirm",title:"歸零小組分數",message:"確定要歸零所有小組的分數嗎？此操作無法復原。",variant:"danger",onConfirm:()=>o("group")}),className:"px-3 py-1.5 text-xs font-bold text-slate-500 dark:text-slate-400 hover:text-rose-600 dark:hover:text-rose-400 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors border border-transparent hover:border-rose-200 dark:hover:border-rose-800",children:"歸零小組分數"})]})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/60 backdrop-blur-[2px] flex items-center justify-center p-6 animate-in fade-in duration-200",children:e.jsxs("div",{className:"w-full max-w-lg bg-white dark:bg-slate-800 rounded-2xl shadow-2xl border border-indigo-100 dark:border-indigo-900 ring-4 ring-indigo-50 dark:ring-indigo-900/30 animate-in zoom-in-95 duration-200 flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/50 rounded-t-2xl",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[i==="new"?e.jsx(xe,{size:18,className:"text-indigo-500"}):e.jsx(Ba,{size:18,className:"text-indigo-500"}),i==="new"?"新增評分項目":"編輯評分項目"]}),e.jsx("button",{onClick:j,className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full text-slate-400 transition-colors",children:e.jsx(ee,{size:18})})]}),e.jsx("div",{className:"p-6 space-y-5",children:e.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 mb-2",children:"圖示 (Icon)"}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{className:"w-14 h-14 flex items-center justify-center text-3xl bg-slate-50 dark:bg-slate-900 rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-700 shrink-0",children:d.icon}),e.jsx("div",{className:"flex-1 grid grid-cols-6 gap-2",children:Ua.map(c=>e.jsx("button",{onClick:()=>x({...d,icon:c}),className:`p-1.5 rounded-lg hover:bg-indigo-50 dark:hover:bg-indigo-900/30 text-xl transition-all ${d.icon===c?"bg-indigo-100 dark:bg-indigo-900/50 ring-2 ring-indigo-400 scale-110":"text-slate-500 dark:text-slate-400"}`,children:c},c))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1",children:"名稱 (Label)"}),e.jsx("input",{type:"text",value:d.label,onChange:c=>x({...d,label:c.target.value}),className:"w-full p-2.5 border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-xl text-sm font-bold focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 outline-none transition-all",placeholder:"例如：發表意見、回答問題...",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1",children:"分數 (Score)"}),e.jsx("input",{type:"number",value:d.score,onChange:c=>x({...d,score:parseInt(c.target.value)||0}),className:`w-full p-2.5 border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 rounded-xl text-sm font-black outline-none focus:ring-2 transition-all ${d.score>=0?"text-emerald-600 dark:text-emerald-400 focus:ring-emerald-400":"text-rose-600 dark:text-rose-400 focus:ring-rose-400"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1",children:"類型 (Type)"}),e.jsxs("select",{value:d.type,onChange:c=>x({...d,type:c.target.value}),className:"w-full p-2.5 border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-xl text-sm font-bold outline-none focus:ring-2 focus:ring-indigo-400 transition-all",children:[e.jsx("option",{value:"positive",children:"加分 (Positive)"}),e.jsx("option",{value:"negative",children:"扣分 (Negative)"})]})]})]})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/50 rounded-b-2xl",children:[i!=="new"?e.jsxs("button",{onClick:()=>b(i),className:"px-4 py-2 text-rose-500 hover:bg-rose-100 dark:hover:bg-rose-900/30 rounded-xl font-bold text-sm flex items-center gap-2 transition-colors",children:[e.jsx(ae,{size:16})," 刪除此項"]}):e.jsx("div",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:j,className:"px-5 py-2.5 text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-xl font-bold text-sm transition-colors",children:"取消"}),e.jsxs("button",{onClick:w,className:"px-6 py-2.5 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg shadow-indigo-200 dark:shadow-none transition-all active:scale-95",children:[e.jsx(mt,{size:18})," 儲存設定"]})]})]})]})})]})},Ba=({size:t,className:s})=>e.jsxs("svg",{width:t,height:t,className:s,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20h9"}),e.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]}),Ha=({isOpen:t,onClose:s,students:r,groupScores:a,attendanceRecords:o,onResetScores:n,onShowDialog:i})=>{if(!t)return null;const l=r.map(b=>{let f=0,j=0,c=0;return o&&Object.values(o).forEach(v=>{const C=v[b.id];C==="absent"?f++:C==="late"?j++:(C==="personal"||C==="sick")&&c++}),{id:b.id,number:b.number,name:b.name,group:b.group||"-",score:b.score||0,absent:f,late:j,leave:c}}).sort((b,f)=>parseInt(b.number)-parseInt(f.number)),d=Object.keys(a||{}).map(b=>({group:b,score:a[b]})).sort((b,f)=>f.score-b.score),x=(b,f)=>"\uFEFF"+[b.join(","),...f.map(c=>c.map(v=>`"${v}"`).join(","))].join(`
`),m=(b,f)=>{const j=new Blob([b],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(j),v=document.createElement("a");v.href=c,v.download=f,v.click(),URL.revokeObjectURL(c)},h=(b,f)=>{const j=[b.join("	"),...f.map(c=>c.join("	"))].join(`
`);navigator.clipboard.writeText(j).then(()=>{i({type:"alert",title:"複製成功",message:"內容已複製到剪貼簿！(可直接貼上 Excel)",variant:"success"})})},u=b=>{const f=["座號","姓名","組別","總分","缺席","遲到","請假"],j=l.map(c=>[c.number,c.name,c.group,c.score,c.absent,c.late,c.leave]);b==="csv"?m(x(f,j),`個人成績與出席統計_${new Date().toLocaleDateString()}.csv`):h(f,j)},y=b=>{const f=["組別","小組總分"],j=d.map(c=>[`第 ${c.group} 組`,c.score]);b==="csv"?m(x(f,j),`小組成績統計_${new Date().toLocaleDateString()}.csv`):h(f,j)},w="text-xs px-3 py-1.5 rounded-lg font-bold flex items-center gap-1 transition-colors";return e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-3xl overflow-hidden flex flex-col max-h-[90vh] border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 bg-slate-800 dark:bg-slate-950 border-b border-slate-700 flex justify-between items-center text-white shrink-0",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(yt,{size:20,className:"text-emerald-400"})," 匯出統計報表"]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-700 rounded-full text-slate-400 hover:text-white transition-colors",children:e.jsx(ee,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-auto flex-1 bg-slate-50 dark:bg-slate-800 space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-purple-500"})," 小組競賽榜"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>y("copy"),className:k(w,"bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"),children:[e.jsx(Ze,{size:14})," 複製"]}),e.jsxs("button",{onClick:()=>y("csv"),className:k(w,"bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 border border-indigo-200 dark:border-indigo-800"),children:[e.jsx(We,{size:14})," 下載 CSV"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-100 dark:border-slate-700",children:e.jsxs("table",{className:"w-full text-sm text-left text-slate-600 dark:text-slate-300",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-bold text-xs uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-20",children:"排名"}),e.jsx("th",{className:"p-3",children:"組別"}),e.jsx("th",{className:"p-3 text-right",children:"總分"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:d.length>0?d.map((b,f)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-3 font-bold text-slate-400 dark:text-slate-500",children:f+1}),e.jsxs("td",{className:"p-3 font-bold text-slate-700 dark:text-slate-200",children:["第 ",b.group," 組"]}),e.jsx("td",{className:"p-3 text-right font-mono font-bold text-emerald-600 dark:text-emerald-400",children:b.score})]},b.group)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"p-6 text-center text-slate-400 italic",children:"尚無小組分數資料"})})})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[e.jsx(je,{size:18,className:"text-blue-500"})," 學生個人紀錄 (含出缺席)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>u("copy"),className:k(w,"bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"),children:[e.jsx(Ze,{size:14})," 複製"]}),e.jsxs("button",{onClick:()=>u("csv"),className:k(w,"bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 border border-indigo-200 dark:border-indigo-800"),children:[e.jsx(We,{size:14})," 下載 CSV"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-100 dark:border-slate-700 max-h-64",children:e.jsxs("table",{className:"w-full text-sm text-left relative text-slate-600 dark:text-slate-300",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-bold text-xs uppercase tracking-wider sticky top-0 shadow-sm z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-16",children:"座號"}),e.jsx("th",{className:"p-3",children:"姓名"}),e.jsx("th",{className:"p-3 w-20 text-center",children:"組別"}),e.jsx("th",{className:"p-3 w-24 text-right",children:"總分"}),e.jsx("th",{className:"p-3 w-20 text-center text-rose-500",children:"缺席"}),e.jsx("th",{className:"p-3 w-20 text-center text-amber-500",children:"遲到"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:l.map(b=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-3 font-mono text-slate-500 dark:text-slate-400",children:b.number}),e.jsx("td",{className:"p-3 font-bold text-slate-700 dark:text-slate-200",children:b.name}),e.jsx("td",{className:"p-3 text-center text-slate-400 dark:text-slate-500 text-xs",children:b.group}),e.jsx("td",{className:k("p-3 text-right font-mono font-bold",b.score<0?"text-rose-500":"text-slate-700 dark:text-slate-200"),children:b.score}),e.jsx("td",{className:"p-3 text-center font-bold text-rose-200 dark:text-rose-900",children:b.absent>0&&e.jsx("span",{className:"text-rose-600 dark:text-rose-400 bg-rose-50 dark:bg-rose-900/30 px-1.5 py-0.5 rounded",children:b.absent})}),e.jsx("td",{className:"p-3 text-center font-bold text-amber-200 dark:text-amber-900",children:b.late>0&&e.jsx("span",{className:"text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/30 px-1.5 py-0.5 rounded",children:b.late})})]},b.id))})]})})]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center shrink-0",children:[e.jsxs("span",{className:"text-xs text-slate-400 dark:text-slate-500 font-bold flex items-center gap-1",children:[e.jsx(fs,{size:14})," 提示：定期匯出並結算分數，可讓系統保持輕量。"]}),n&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>i({type:"confirm",title:"結算個人分數",message:`確定要結算並清除所有「學生個人」的分數嗎？
請確認您已匯出備份，此動作無法復原。`,variant:"danger",confirmText:"結算並清除",onConfirm:()=>{n("student"),s()}}),className:"px-4 py-2 bg-white dark:bg-slate-800 border border-rose-200 dark:border-rose-900/50 text-rose-600 dark:text-rose-400 text-xs font-bold rounded-lg hover:bg-rose-50 dark:hover:bg-rose-900/20 hover:border-rose-300 dark:hover:border-rose-800 transition-all flex items-center gap-2",children:[e.jsx(ae,{size:14})," 結算個人分數"]}),e.jsxs("button",{onClick:()=>i({type:"confirm",title:"結算小組分數",message:`確定要結算並清除所有「小組」的分數嗎？
請確認您已匯出備份，此動作無法復原。`,variant:"danger",confirmText:"結算並清除",onConfirm:()=>{n("group"),s()}}),className:"px-4 py-2 bg-white dark:bg-slate-800 border border-rose-200 dark:border-rose-900/50 text-rose-600 dark:text-rose-400 text-xs font-bold rounded-lg hover:bg-rose-50 dark:hover:bg-rose-900/20 hover:border-rose-300 dark:hover:border-rose-800 transition-all flex items-center gap-2",children:[e.jsx(ae,{size:14})," 結算小組分數"]})]})]})]})})},Va=({isOpen:t,onClose:s,student:r,behaviors:a=[],onScore:o,defaultMode:n="individual"})=>{if(!t||!r)return null;const i=r.mode||n;let l="individual",d=r.name,x=r.number?`座號: ${r.number}`:"",m=e.jsx(je,{size:20}),h="bg-slate-800 dark:bg-slate-950",u="bg-slate-700 dark:bg-slate-800";switch(i){case"class":l="class",d="全班同學",x="Classroom",m=e.jsx(le,{size:20}),h="bg-indigo-600 dark:bg-indigo-900",u="bg-indigo-700 dark:bg-indigo-800";break;case"group_members":l="group_members",x="Group Members",m=e.jsx(ut,{size:20}),h="bg-pink-600 dark:bg-pink-900",u="bg-pink-700 dark:bg-pink-800";break;case"group":l="group",x="Group Entity",m=e.jsx(me,{size:20}),h="bg-purple-600 dark:bg-purple-900",u="bg-purple-700 dark:bg-purple-800";break;default:l="individual";break}const y=c=>Number(c.score)||0,w=c=>{let v=r.id;l==="class"?v="all":(l==="group"||l==="group_members")&&(v=r.group);const C={...c,score:y(c)};o(v,C,l)},b=Array.isArray(a)?a:[],f=b.filter(c=>y(c)>=0),j=b.filter(c=>y(c)<0);return e.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-[1px] transition-opacity duration-300 pointer-events-auto",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-sm h-full bg-white dark:bg-slate-900 shadow-2xl flex flex-col pointer-events-auto animate-in slide-in-from-right duration-300 border-l border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:`p-5 flex justify-between items-start text-white shrink-0 ${h}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2.5 rounded-xl ${u} shadow-inner`,children:m}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl leading-tight",children:d}),x&&e.jsx("p",{className:"text-xs text-white/60 font-medium tracking-wide mt-0.5",children:x})]})]}),e.jsx("button",{onClick:s,className:"p-2 -mr-2 -mt-2 hover:bg-white/20 rounded-full text-white/80 transition-colors",children:e.jsx(ee,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden bg-slate-50 dark:bg-slate-800",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-400 dark:text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2 px-1",children:[e.jsx(wr,{size:14,className:"text-emerald-500"})," 加分項目"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.map(c=>e.jsxs("button",{onClick:()=>w(c),className:"group relative p-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-700 shadow-sm hover:border-emerald-400 dark:hover:border-emerald-500 hover:ring-1 hover:ring-emerald-400 hover:shadow-md transition-all active:scale-95 flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-3xl group-hover:scale-110 transition-transform duration-200 filter drop-shadow-sm",children:c.icon}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 text-center leading-tight",children:c.label}),e.jsxs("span",{className:"absolute top-2 right-2 text-[10px] font-black text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/30 px-1.5 py-0.5 rounded-md border border-emerald-100 dark:border-emerald-800",children:["+",y(c)]})]},c.id)),f.length===0&&e.jsx("div",{className:"col-span-full text-center text-xs text-slate-400 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50/50 dark:bg-slate-800/50 py-6",children:"尚無加分項目"})]})]}),j.length>0&&e.jsxs("div",{className:"p-4 pt-0",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-400 dark:text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2 px-1 mt-2",children:[e.jsx(yr,{size:14,className:"text-rose-500"})," 扣分/提醒"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:j.map(c=>e.jsxs("button",{onClick:()=>w(c),className:"group relative p-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-700 shadow-sm hover:border-rose-400 dark:hover:border-rose-500 hover:ring-1 hover:ring-rose-400 hover:shadow-md transition-all active:scale-95 flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-3xl group-hover:scale-110 transition-transform duration-200 grayscale opacity-70 group-hover:grayscale-0 group-hover:opacity-100",children:c.icon}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 text-center leading-tight",children:c.label}),e.jsx("span",{className:"absolute top-2 right-2 text-[10px] font-black text-rose-600 dark:text-rose-400 bg-rose-50 dark:bg-rose-900/30 px-1.5 py-0.5 rounded-md border border-rose-100 dark:border-rose-800",children:y(c)})]},c.id))})]})]}),e.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 text-center text-[10px] text-slate-400",children:"點擊項目即可評分"})]})]})},Xa=({isOpen:t,onClose:s,student:r,onSave:a})=>{const[o,n]=N.useState({name:"",number:"",gender:"M",group:"",performance:""});if(N.useEffect(()=>{r&&n({...r,group:r.group||"",performance:r.performance!==void 0&&r.performance!==null?r.performance:""})},[r,t]),!t)return null;const i=(m,h)=>{n(u=>({...u,[m]:h}))},l="w-full p-2 border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-400 outline-none transition-colors",d="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1",x=()=>{a(o),s()};return e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md overflow-hidden scale-100 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(je,{className:"text-blue-500",size:20})," 編輯學生資料"]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full text-slate-400",children:e.jsx(ee,{size:16})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:d,children:"座號"}),e.jsx("input",{type:"text",value:o.number,onChange:m=>i("number",m.target.value),className:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:d,children:"姓名"}),e.jsx("input",{type:"text",value:o.name,onChange:m=>i("name",m.target.value),className:l})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:d,children:"性別"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i("gender","M"),className:k("flex-1 py-2 rounded-lg border font-bold transition-all",o.gender==="M"?"bg-blue-100 dark:bg-blue-900/30 border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"),children:"男生"}),e.jsx("button",{onClick:()=>i("gender","F"),className:k("flex-1 py-2 rounded-lg border font-bold transition-all",o.gender==="F"?"bg-pink-100 dark:bg-pink-900/30 border-pink-300 dark:border-pink-700 text-pink-700 dark:text-pink-400":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"),children:"女生"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:d,children:"組別"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[[1,2,3,4,5,6,7,8].map(m=>e.jsx("button",{onClick:()=>i("group",m.toString()),className:k("w-8 h-8 rounded-full font-bold text-sm border flex items-center justify-center transition-all",o.group===m.toString()?"bg-slate-800 dark:bg-white text-white dark:text-slate-900 border-slate-800 dark:border-white scale-110 shadow-md":"bg-white dark:bg-slate-700 text-slate-500 dark:text-slate-400 border-slate-200 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-600"),children:m},m)),e.jsx("button",{onClick:()=>i("group",""),className:k("px-3 h-8 rounded-full font-bold text-xs border flex items-center justify-center transition-all",o.group?"bg-white dark:bg-slate-700 text-slate-400 dark:text-slate-500 border-slate-200 dark:border-slate-600":"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800"),children:"無"})]}),e.jsx("input",{type:"text",placeholder:"或輸入自訂組別名稱...",value:o.group,onChange:m=>i("group",m.target.value),className:k(l,"text-sm")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:k(d,"flex items-center gap-1"),children:[e.jsx(fe,{size:12})," 參考成績 (選填)"]}),e.jsx("input",{type:"number",min:"0",max:"100",placeholder:"輸入 S 型分組用的參考數值 (0-100)",value:o.performance,onChange:m=>i("performance",m.target.value),className:k(l,"font-mono")})]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"取消"}),e.jsx("button",{onClick:x,className:"px-4 py-2 text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 rounded-lg shadow-sm transition-colors",children:"儲存"})]})]})})},tl=()=>{const{currentClass:t,updateClass:s,saveTemplate:r,deleteTemplate:a,applyTemplate:o,toggleLock:n,toggleVoid:i,seatDrop:l,sidebarDrop:d,updateStudent:x,updateStudents:m,scoreStudent:h,resetScores:u,updateBehaviors:y,updateAttendance:w,templates:b,feedbacks:f,undo:j,redo:c,canUndo:v,canRedo:C,seatMode:M,setSeatMode:g}=be(),{parseImportText:_}=ka();Qt({escape:()=>{E?A():F?L():(K||he)&&oe(!1)},f:()=>He(),"ctrl+z":()=>{v&&j()},"ctrl+y":()=>{C&&c()},"ctrl+shift+z":()=>{C&&c()},"alt+1":()=>{B("score"),ge(null)},"alt+2":()=>{B("arrange"),ge(null)},s:()=>{W==="arrange"&&g("swap")},r:()=>{W==="arrange"&&g("replace")}});const{activeModal:E,modalData:z,openModal:D,closeModal:A,isModalOpen:S,dialogConfig:F,openDialog:O,closeDialog:L}=ye(),V=N.useCallback(R=>{O({...R,onConfirm:I=>{R.onConfirm&&R.onConfirm(I),L()}})},[O,L]),[G,te]=N.useState(!1),[ne,q]=N.useState(!1),[J,$]=N.useState(!1),[U,se]=N.useState("group"),[W,B]=N.useState("score"),[K,oe]=N.useState(!1),[X,Rt]=N.useState("management"),[he,Ne]=N.useState(!1),[Ae,Le]=N.useState(!1),[Oe,Pe]=N.useState(!1),[Fe,Ue]=N.useState(!1),[Ce,Se]=N.useState(!0),[Q,Ge]=N.useState(!0),[ue,ge]=N.useState(null),[Dt,It]=N.useState(null),$e=N.useRef(null),Te=N.useRef(null),At=new Date().toLocaleDateString("en-CA"),Ee=t?.attendanceRecords?.[At]||{};N.useEffect(()=>{if(t?.students){const R=t.students.some(I=>I.group&&String(I.group).trim()!=="");se(R?"group":"normal")}},[t.id]);const[Ya,Lt]=N.useState(1);N.useEffect(()=>{const R=()=>{if(Te.current){const{clientWidth:I,clientHeight:Me}=Te.current,pe=I/1200,Ft=Me/800;Lt(Math.min(Math.max(Math.min(pe,Ft),.5),1.2))}};return window.addEventListener("resize",R),R(),()=>window.removeEventListener("resize",R)},[K,he,Q]),N.useEffect(()=>{Q&&(oe(!1),Ne(!1))},[Q]);const Ot=R=>{const I=_(R);I.length>0?O({type:"confirm",title:"確認匯入名單",message:`成功解析 ${I.length} 筆資料。
這將重置座位表，確定嗎？`,onConfirm:()=>{s({...t,students:I,layout:{...t.layout,seats:{},voidSeats:[]},scoreLogs:[]}),q(!1)}}):O({type:"alert",title:"格式錯誤",message:"無法解析資料，請檢查格式是否包含：座號 姓名"})},Be=N.useCallback(R=>{if(R){if(ue){const I=ue==="add"?1:-1;h(R.id,{id:"batch_quick",value:I,score:I,label:I>0?"快速加分":"快速扣分",type:I>0?"positive":"negative",isQuick:!0},"individual");return}if(W==="arrange"){D(P.EDIT_STUDENT,R);return}W==="score"&&D(P.SCORING,R)}},[ue,W,h,D]),Pt=async()=>{if($e.current){D(P.DIALOG,{type:"alert",title:"影像處理中",message:"正在產生高品質座位表（4x 採樣），這可能需要幾秒鐘..."});try{const R=await fa($e.current,{pixelRatio:4,quality:1,filter:Me=>{const pe=Me.classList;return pe?!pe.contains("no-print"):!0}}),I=document.createElement("a");I.href=R,I.download=`${t.name}_座位表_HD.png`,I.click(),A()}catch(R){console.error("匯出失敗:",R),D(P.DIALOG,{type:"alert",title:"匯出失敗",message:"請確認瀏覽器支援快照功能，或嘗試縮小視窗後再試一次。"})}}},He=()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(R=>console.error(R))};return e.jsxs("div",{className:`flex h-full ${p.BACKGROUND} transition-colors duration-500 overflow-hidden font-sans`,children:[e.jsx(Ia,{isOpen:S(P.LAYOUT_TEMPLATE),onClose:A,currentLayout:t?.layout,templates:b,onApplyTemplate:o,onSaveTemplate:r,onDeleteTemplate:a,onShowDialog:V}),e.jsx(Xa,{isOpen:S(P.EDIT_STUDENT),onClose:A,student:z,onSave:x}),e.jsx(Fa,{isOpen:S(P.BATCH_GROUP),onClose:A,students:t?.students,onUpdateStudents:m,onShowDialog:V}),e.jsx(hs,{isOpen:S(P.ATTENDANCE),onClose:A,students:t?.students,attendanceRecords:t?.attendanceRecords,onSave:w,onShowDialog:V}),e.jsx(Va,{isOpen:S(P.SCORING),student:z?.student||z,behaviors:t?.behaviors,onClose:()=>{A(),It(null)},onScore:h,defaultMode:z?.mode||"individual"}),e.jsx(Ga,{isOpen:S(P.BEHAVIOR_SETTINGS),onClose:A,behaviors:t?.behaviors,onUpdateBehaviors:y,onResetScores:u,onShowDialog:V}),e.jsx(Ha,{isOpen:S(P.EXPORT_STATS),onClose:A,students:t?.students,groupScores:t?.groupScores,attendanceRecords:t?.attendanceRecords||{},onResetScores:u,onShowDialog:V}),e.jsx(Jt,{isOpen:!!F,onClose:L,...F||{}}),e.jsx(Ca,{feedbacks:f,mode:""}),(Q||!K&&!he)&&e.jsx("div",{className:"absolute top-3 right-4 z-[70] animate-in slide-in-from-right-4 fade-in duration-500 no-print print:hidden",children:e.jsxs("button",{onClick:()=>{Ge(!1),oe(!0),Ne(!0)},className:"px-4 py-2 bg-white/90 dark:bg-blue-900/50 backdrop-blur text-blue-600 dark:text-blue-200 rounded-full shadow-xl font-bold flex items-center gap-2 hover:bg-blue-50 hover:dark:bg-blue-500/50 hover:scale-105 transition-all border border-blue-200 dark:border-blue-500",children:[e.jsx(vt,{size:18})," ",e.jsx("span",{className:"font-bold",children:"詳細模式"})]})}),!Ce&&(Q||!he)&&e.jsx("div",{className:"absolute top-15 right-4 z-[70] animate-in slide-in-from-right-4 fade-in duration-500 no-print print:hidden",children:e.jsxs("button",{onClick:()=>Se(!0),className:"px-4 py-2 bg-white/90 dark:bg-amber-900/50 backdrop-blur text-amber-600 dark:text-amber-200 rounded-full shadow-xl font-bold flex items-center gap-2 hover:bg-amber-50 hover:dark:bg-amber-500/50 hover:scale-105 transition-all border border-amber-200 dark:border-amber-500 shadow-amber-100/50 dark:shadow-amber-700/50",children:[e.jsx(me,{size:18})," 評分工具"]})}),e.jsx(wa,{isOpen:K&&!Q,onClose:()=>oe(!1),activeTab:X,setActiveTab:Rt,isEditingList:ne,setIsEditingList:q,displayMode:U,appMode:W,onStudentClick:Be,onDragStart:(R,I)=>R.dataTransfer.setData("studentId",I),onDrop:d,onImportList:Ot}),e.jsxs("div",{className:`flex-1 flex flex-col relative overflow-hidden ${p.CONTENT_AREA} transition-all duration-500`,children:[e.jsx(va,{isSidebarOpen:K,setIsSidebarOpen:oe,isToolbarOpen:he&&!Q,setIsToolbarOpen:Ne,appMode:W,handleSwitchMode:R=>{B(R),ge(null)},showShuffleMenu:J,setShowShuffleMenu:$,cycleDisplayMode:()=>se(R=>({normal:"gender",gender:"group",group:"normal"})[R]),getDisplayModeLabel:()=>({normal:"一般",gender:"性別",group:"小組"})[U],handleExportImage:Pt,toggleFullscreen:He,setIsLotteryOpen:Ue,setIsTimerOpen:Pe,isLotteryOpen:Fe,isTimerOpen:Oe,isTeacherView:G,setIsTeacherView:te,isSoundBoardOpen:Ae,setIsSoundBoardOpen:Le,isScoreTickerOpen:Ce,setIsScoreTickerOpen:Se,isFocusMode:Q,setIsFocusMode:Ge}),e.jsx(Ma,{groupScores:t?.groupScores,students:t?.students,isVisible:Ce&&W==="score",onClose:()=>Se(!1),batchScoreMode:ue,onToggleBatchMode:R=>ge(I=>I===R?null:R),onQuickScore:(R,I)=>h(R,{id:"group_quick",value:I,score:I,type:I>0?"positive":"negative",isQuick:!0},"group"),onDetailScore:R=>D(P.SCORING,{mode:"group_members",group:R,name:`第 ${R} 組 (全員)`}),onClassScore:()=>D(P.SCORING,{mode:"class",name:"全班同學"})}),e.jsx(rs,{isOpen:Fe,onClose:()=>Ue(!1),classes:t?[t]:[],defaultClassId:t?.id,attendanceStatus:Ee}),e.jsx(as,{isOpen:Oe,onClose:()=>Pe(!1),students:t?.students,attendanceStatus:Ee}),e.jsx(ls,{isOpen:Ae,onClose:()=>Le(!1)}),e.jsx("div",{ref:Te,className:`flex-1 p-4 md:p-8 flex flex-col items-center justify-center overflow-auto ${ue?"cursor-crosshair":""}`,children:e.jsxs("div",{className:"flex flex-col items-center w-full max-w-6xl",ref:$e,children:[e.jsx("div",{className:`w-full max-w-4xl h-10 mb-6 rounded-xl flex items-center justify-center text-white font-bold tracking-widest shadow-lg transition-all duration-500 ${G?"bg-slate-500 dark:bg-slate-700":"bg-slate-700 dark:bg-slate-800 border border-slate-600"}`,children:G?"教室後方 / 布告欄":"講台 / 黑板"}),e.jsx("div",{className:`relative ${p.SURFACE_GLASS} rounded-3xl shadow-2xl p-8 md:p-12 border-4 ${p.BORDER_LIGHT} max-w-5xl w-full mx-auto flex-1 flex flex-col overflow-hidden`,children:e.jsx(_t,{layout:t?.layout,students:t?.students||[],isTeacherView:G,onSeatDrop:l,onStudentClick:Be,displayMode:U,appMode:W,attendanceStatus:Ee,onToggleVoid:i,onToggleLock:n,hoveredGroup:Dt})}),e.jsx("div",{className:`w-full max-w-4xl h-10 mt-6 rounded-xl flex items-center justify-center text-white font-bold tracking-widest shadow-lg transition-all duration-500 ${G?"bg-slate-700 dark:bg-slate-800 border border-slate-600":"bg-slate-500 dark:bg-slate-700"}`,children:G?"講台 / 黑板":"教室後方 / 布告欄"})]})})]})]})};export{tl as default};
