// src/constants/polyphoneDict.js

// ============================================================================
// æºæ³‰æ³¨éŸ³åœ“é«” (ButTaiwan bpmfvs) å®˜æ–¹ IVS è®Šé«”å°ç…§è¡¨
// âš ï¸ æ³¨æ„ï¼šå„å€‹ç ´éŸ³å­—ç©¶ç«Ÿæ˜¯ IVS_2 é‚„æ˜¯ IVS_3ï¼Œå–æ±ºæ–¼è©²å­—é«”å…§éƒ¨çš„å­—å…¸æŽ’åºã€‚
// è‹¥ç™¼ç¾ç•«é¢ä¸Šçš„æ³¨éŸ³ä¸å°ï¼Œåªéœ€åœ¨æ­¤å°‡ IVS_2 æ”¹ç‚º IVS_3 (æˆ–åä¹‹) å³å¯å¾®èª¿ã€‚
// ============================================================================
const IVS_2 = '\uDB40\uDDE1'; // ç¬¬äºŒè®€éŸ³ (U+E01E1)
const IVS_3 = '\uDB40\uDDE2'; // ç¬¬ä¸‰è®€éŸ³ (U+E01E2)
const IVS_4 = '\uDB40\uDDE3'; // ç¬¬å››è®€éŸ³ (U+E01E3)
const IVS_5 = '\uDB40\uDDE4'; // ç¬¬å››è®€éŸ³ (U+E01E4)

// ----------------------------------------------------------------------------
// 1. ã€è®Šèª¿å°ˆå€ã€‘ (ä¸€ã€ä¸)
// ----------------------------------------------------------------------------
const SANDHI_WORDS = {
  // ã€Œä¸€ã€è®Šèª¿ (é è¨­æœ¬éŸ³ ã„§ï¼Œé‡å››è²è®ŠäºŒè² ã„§ËŠï¼Œé‡ä¸€äºŒä¸‰è²è®Šå››è² ã„§Ë‹)
  // å‡è¨­ IVS_2 æ˜¯ ã„§ËŠï¼ŒIVS_3 æ˜¯ ã„§Ë‹ (è«‹ä¾å¯¦éš›å­—é«”é¡¯ç¤ºç•«é¢èª¿æ•´)
  'ä¸€å€‹': `ä¸€${IVS_2}å€‹`, 'ä¸€æ¬¡': `ä¸€${IVS_2}æ¬¡`, 'ä¸€å®š': `ä¸€${IVS_2}å®š`,
  'ä¸€åŠ': `ä¸€${IVS_2}åŠ`, 'ä¸€æ¨£': `ä¸€${IVS_2}æ¨£`, 'ä¸€é™£': `ä¸€${IVS_2}é™£`,
  'ä¸€åˆ‡': `ä¸€${IVS_2}åˆ‡`, 'ä¸€å¡Š': `ä¸€${IVS_2}å¡Š`, 'ä¸€éƒ¨': `ä¸€${IVS_2}éƒ¨`,
  
  'ä¸€ç›´': `ä¸€${IVS_3}ç›´`, 'ä¸€èµ·': `ä¸€${IVS_3}èµ·`, 'ä¸€å¤©': `ä¸€${IVS_3}å¤©`,
  'ä¸€ç”Ÿ': `ä¸€${IVS_3}ç”Ÿ`, 'ä¸€èˆ¬': `ä¸€${IVS_3}èˆ¬`, 'ä¸€äº›': `ä¸€${IVS_3}äº›`,
  'ä¸€é»ž': `ä¸€${IVS_3}é»ž`, 'ä¸€éš»': `ä¸€${IVS_3}éš»`, 'ä¸€é‚Š': `ä¸€${IVS_3}é‚Š`,

  // ã€Œä¸ã€è®Šèª¿ (é è¨­æœ¬éŸ³ ã„…ã„¨Ë‹ï¼Œé‡å››è²è®ŠäºŒè² ã„…ã„¨ËŠ)
  'ä¸æ˜¯': `ä¸${IVS_2}æ˜¯`, 'ä¸è¦': `ä¸${IVS_2}è¦`, 'ä¸å°': `ä¸${IVS_2}å°`,
  'ä¸éŒ¯': `ä¸${IVS_2}éŒ¯`, 'ä¸æœƒ': `ä¸${IVS_2}æœƒ`, 'ä¸å†': `ä¸${IVS_2}å†`,
  'ä¸ç”¨': `ä¸${IVS_2}ç”¨`, 'ä¸å¤ ': `ä¸${IVS_2}å¤ `, 'ä¸è¦‹': `ä¸${IVS_2}è¦‹`,
};

// ----------------------------------------------------------------------------
// 2. ã€ç”Ÿæ´»èˆ‡æ ¡åœ’é«˜é »ç ´éŸ³å­—ã€‘ (ä¾ç­†ç•«æˆ–å¸¸è¦‹åº¦åˆ†é¡ž)
// ----------------------------------------------------------------------------
const FREQUENT_WORDS = {
  // ã€é•·ã€‘ é è¨­ ã„”ã„¤ËŠ / ç ´éŸ³ ã„“ã„¤Ë‡
  'æ ¡é•·': `æ ¡é•·${IVS_2}`, 'é•·å¤§': `é•·${IVS_2}å¤§`, 'æ‘é•·': `æ‘é•·${IVS_2}`, 
  'ç­é•·': `ç­é•·${IVS_2}`, 'å¸«é•·': `å¸«é•·${IVS_2}`, 'æˆé•·': `æˆé•·${IVS_2}`,
  'è¡Œé•·': `è¡Œ${IVS_2}é•·${IVS_2}`,

  // ã€è¡Œã€‘ é è¨­ ã„’ã„§ã„¥ËŠ / ç ´éŸ³ ã„ã„¤ËŠ (æˆ–åä¹‹)
  'éŠ€è¡Œ': `éŠ€è¡Œ${IVS_2}`, 'è¡Œæ¥­': `è¡Œ${IVS_2}æ¥­`, 
  'å…§è¡Œ': `å…§è¡Œ${IVS_2}`, 'å¤–è¡Œ': `å¤–è¡Œ${IVS_2}`,
  'ä¸Šä¸€è¡Œ': `ä¸Šä¸€${IVS_3}è¡Œ${IVS_2}`,'ä¸‹ä¸€è¡Œ': `ä¸‹ä¸€${IVS_3}è¡Œ${IVS_2}`,

  // ã€æ¨‚ã€‘ é è¨­ ã„Œã„œË‹ / ç ´éŸ³ ã„©ã„Ë‹
  'éŸ³æ¨‚': `éŸ³æ¨‚${IVS_2}`, 'æ¨‚å™¨': `æ¨‚${IVS_2}å™¨`, 'æ¨‚éšŠ': `æ¨‚${IVS_2}éšŠ`, 
  'åœ‹æ¨‚': `åœ‹æ¨‚${IVS_2}`, 'å¼¦æ¨‚': `å¼¦æ¨‚${IVS_2}`,

  // ã€è¦ºã€‘ é è¨­ ã„ã„©ã„ËŠ / ç ´éŸ³ ã„ã„§ã„ Ë‹
  'ç¡è¦º': `ç¡è¦º${IVS_2}`, 'åˆè¦º': `åˆè¦º${IVS_2}`,

  // ã€æ•™ã€‘ é è¨­ ã„ã„§ã„ Ë‹ / ç ´éŸ³ ã„ã„§ã„ 
  'æ•™æ›¸': `æ•™${IVS_2}æ›¸`, 'æ•™äºº': `æ•™${IVS_2}äºº`,

  // ã€é‡ã€‘ é è¨­ ã„“ã„¨ã„¥Ë‹ / ç ´éŸ³ ã„”ã„¨ã„¥ËŠ
  'é‡è¤‡': `é‡${IVS_2}è¤‡`, 'é‡æ–°': `é‡${IVS_2}æ–°`, 'é‡ä¾†': `é‡${IVS_2}ä¾†`,
  'é‡ç–Š': `é‡${IVS_2}ç–Š`,

  // ã€ç‚ºã€‘ é è¨­ ã„¨ã„ŸËŠ / ç ´éŸ³ ã„¨ã„ŸË‹
  'å› ç‚º': `å› ç‚º${IVS_2}`, 'ç‚ºäº†': `ç‚º${IVS_2}äº†`, 'ç‚ºä»€éº¼': `ç‚º${IVS_2}ä»€éº¼`,
  'ä»¥ç‚º': `ä»¥ç‚º${IVS_2}`, // é è¨­ ã„¨ã„ŸËŠ

  // ã€è™•ã€‘ ç ´éŸ³ ã„”ã„¨Ë‹ / é è¨­ ã„”ã„¨Ë‡
  'å­¸å‹™è™•': `å­¸å‹™è™•${IVS_2}`, 'æ•™å‹™è™•': `æ•™å‹™è™•${IVS_2}`, 'ç¸½å‹™è™•': `ç¸½å‹™è™•${IVS_2}`,

  // ã€å€’ã€‘ ç ´éŸ³ ã„‰ã„ Ë‡ / é è¨­ ã„‰ã„ Ë‹
  
  'è·Œå€’': `è·Œå€’${IVS_2}`, // é è¨­ ã„‰ã„ Ë‡

  // ã€ç©ºã€‘ é è¨­ ã„Žã„¨ã„¥ / ç ´éŸ³ ã„Žã„¨ã„¥Ë‹
  'ç©ºåœ°': `ç©º${IVS_2}åœ°`, 'ç©ºç™½': `ç©º${IVS_2}ç™½`, 'æœ‰ç©º': `æœ‰ç©º${IVS_2}`,

  // ã€ç›¸ã€‘ é è¨­ ã„’ã„§ã„¤ / ç ´éŸ³ ã„’ã„§ã„¤Ë‹
  'ç…§ç›¸': `ç…§ç›¸${IVS_2}`, 'ç›¸ç‰‡': `ç›¸${IVS_2}ç‰‡`, 'é•·ç›¸': `é•·ç›¸${IVS_2}`,
  'ç›¸æ©Ÿ': `ç›¸${IVS_2}æ©Ÿ`,

  // ã€ç•¶ã€‘ é è¨­ ã„‰ã„¤ / ç ´éŸ³ ã„‰ã„¤Ë‹
  'ä¾¿ç•¶': `ä¾¿ç•¶${IVS_2}`, 'ä¸Šç•¶': `ä¸Šç•¶${IVS_2}`, 'å¦¥ç•¶': `å¦¥ç•¶${IVS_2}`,
  'ç•¶é‹ª': `ç•¶${IVS_2}é‹ª`,

  // ã€å‡ã€‘ é è¨­ ã„ã„§ã„šË‡ / ç ´éŸ³ ã„ã„§ã„šË‹
  'æ”¾å‡': `æ”¾å‡${IVS_2}`, 'æš‘å‡': `æš‘å‡${IVS_2}`, 'å¯’å‡': `å¯’å‡${IVS_2}`,
  'è«‹å‡': `è«‹å‡${IVS_2}`, 'æ˜¥å‡': `æ˜¥å‡${IVS_2}`,

  // ã€å¥½ã€‘ é è¨­ ã„ã„ Ë‡ / ç ´éŸ³ ã„ã„ Ë‹
  'å¥½å¥‡': `å¥½${IVS_2}å¥‡`, 'å¥½å‹•': `å¥½${IVS_2}å‹•`, 'æ„›å¥½': `æ„›å¥½${IVS_2}`,

  // ã€å·®ã€‘ é è¨­ ã„”ã„š / ç ´éŸ³ ã„”ã„šË‹ / ã„”ã„ž / ã„˜
  'å¾ˆå·®': `å¾ˆå·®${IVS_5}`, 'å·®ä¸å¤š': `å·®${IVS_5}ä¸å¤š`, // ã„”ã„šË‹
  'å‡ºå·®': `å‡ºå·®${IVS_2}`, 'éƒµå·®': `éƒµå·®${IVS_2}`,     // ã„”ã„ž
  'åƒå·®': `åƒ${IVS_3}å·®${IVS_3}`,                         // ã„˜
  'äººåƒ': `äººåƒ${IVS_2}`,
    // ã€å¾—ã€‘ ã„‰ã„œËŠ / ã„‰ã„ŸË‡
  'å¾—è¦': `å¾—${IVS_3}è¦`,
  'å¾—å…ˆ': `å¾—${IVS_3}å…ˆ`,
  'å¾—åš': `å¾—${IVS_3}åš`,
  'ä½ å¾—': `ä½ å¾—${IVS_3}`, // éœ€è¦–å­—é«”æ˜¯å¦æ”¯æ´

  // ã€è‘—ã€‘ ã„“ã„œË™ / ã„“ã„ ËŠ / ã„“ã„¨ã„›ËŠ / ã„“ã„ 
  'çœ‹è‘—': `çœ‹è‘—${IVS_2}`,   // ã„“ã„œË™ï¼ˆè‹¥å­—é«”é è¨­ä¸æ˜¯ï¼‰
  'æƒ³è‘—': `æƒ³è‘—${IVS_2}`,
  'æ€¥è‘—': `æ€¥è‘—${IVS_2}`,
  'è‘—ç«': `è‘—${IVS_3}ç«`,   // ã„“ã„ ËŠ
  'è‘—æ€¥': `è‘—${IVS_3}æ€¥`,   // ã„“ã„ ËŠ
  'è‘—å': `è‘—${IVS_3}å`,   // ã„“ã„¨ã„›ËŠï¼ˆä¾å­—é«”å¯èƒ½ä¸åŒï¼‰

  // ã€é‚„ã€‘ ã„ã„žËŠ / ã„ã„¨ã„¢ËŠ
  'é‚„æœ‰': `é‚„${IVS_3}æœ‰`,
  'é‚„æ²’': `é‚„${IVS_3}æ²’`,
  'é‚„æ˜¯': `é‚„${IVS_3}æ˜¯`,
  'æ­¸é‚„': `æ­¸é‚„${IVS_2}`,
  'é‚„æ›¸': `é‚„${IVS_2}æ›¸`,

  // ã€æ›´ã€‘ ã„ã„¥ / ã„ã„¥Ë‹
  'ä¸‰æ›´': `ä¸‰æ›´${IVS_2}`, // ã„ã„¥ï¼ˆè‹¥å­—é«”é è¨­ç›¸åï¼‰

  // ã€è¦ã€‘ ã„§ã„ Ë‹ / ã„§ã„ ï¼ˆè¦ä¸è¦/éœ€è¦ï¼‰
  'è¦æ±‚': `è¦${IVS_2}æ±‚`,
  'é‡è¦': `é‡è¦`, // ä½ å·²æœ‰ã€Œé‡ã€ï¼›é€™æ˜¯å¸¸è¦‹æ­é…
  'éœ€è¦': `éœ€${IVS_2}è¦`, // è‹¥å­—é«”æœ‰è¨­è¨ˆ
  'è¦ä¸è¦': `è¦${IVS_3}ä¸è¦`, // ã„§ã„ ï¼ˆè¦–å­—é«”ï¼‰

  // ã€å’Œã€‘ ã„ã„œËŠ / ã„ã„¢Ë‹ / ã„ã„¨ã„›Ë‹
  'å’Œéºµ': `å’Œ${IVS_4}éºµ`,
  

  // ã€ä¸­ã€‘ ã„“ã„¨ã„¥ / ã„“ã„¨ã„¥Ë‹ï¼ˆå‘½ä¸­ã€æ“Šä¸­ï¼‰
  'æ‰“ä¸­': `æ‰“ä¸­${IVS_2}`,
  'å‘½ä¸­': `å‘½ä¸­${IVS_2}`,
  'é¸ä¸­': `é¸ä¸­${IVS_2}`,

  // ã€åˆ†ã€‘ ã„ˆã„£ / ã„ˆã„£Ë‹
  'åˆ†æ•¸': `åˆ†${IVS_2}æ•¸`,
  'èº«åˆ†': `èº«åˆ†${IVS_2}`,
  'åˆ†å…§': `åˆ†${IVS_2}å…§`,

  // ã€é‡ã€‘ ã„Œã„§ã„¤ËŠ / ã„Œã„§ã„¤Ë‹
  'åŠ›é‡': `åŠ›${IVS_2}é‡`,  // ã„Œã„§ã„¤ËŠ
  'æ¸¬é‡': `æ¸¬é‡${IVS_2}`,  // ã„Œã„§ã„¤ËŠ
  'é‡æ¯': `é‡${IVS_3}æ¯`,  // ã„Œã„§ã„¤Ë‹
  'é‡ä¸€é‡': `é‡${IVS_3}ä¸€é‡${IVS_3}`,

  // ã€ä¾¿ã€‘ ã„…ã„§ã„¢Ë‹ / ã„†ã„§ã„¢ËŠ
  'ä¾¿å®œ': `ä¾¿${IVS_2}å®œ`, // ã„†ã„§ã„¢ËŠ
  'éš¨ä¾¿': `éš¨ä¾¿${IVS_3}`, // ã„…ã„§ã„¢Ë‹
};

// ----------------------------------------------------------------------------
// 3. ã€åœ‹é«˜ä¸­é€²éšŽæ˜“éŒ¯å­—éŸ³ã€‘ (å¸¸è€ƒé¡Œ)
// ----------------------------------------------------------------------------
const ADVANCED_WORDS = {
  'æœƒè¨ˆ': `æœƒ${IVS_2}è¨ˆ`, // ã„Žã„¨ã„žË‹
  'æ»‘ç¨½': `æ»‘${IVS_2}ç¨½`, // ã„ã„¨Ë‡
  'ä¸»è§’': `ä¸»è§’${IVS_2}`, 'è§’è‰²': `è§’${IVS_2}è‰²`, // ã„ã„©ã„ËŠ
  'èªªå®¢': `èªª${IVS_2}å®¢`, 'æ¸¸èªª': `æ¸¸èªª${IVS_2}`, // ã„•ã„¨ã„ŸË‹
  'å‰µå‚·': `å‰µ${IVS_2}å‚·`, // ã„”ã„¨ã„¤
  'å¦æ¥µæ³°ä¾†': `å¦${IVS_2}æ¥µæ³°ä¾†`, // ã„†ã„§Ë‡
};

// ============================================================================
// åˆä½µåŒ¯å‡ºèˆ‡æŽ’åºå¼•æ“Ž
// ============================================================================
export const POLYPHONE_MAP = {
  ...SANDHI_WORDS,
  ...FREQUENT_WORDS,
  ...ADVANCED_WORDS,
};

// ðŸŒŸ æœ€å¤§åŒ¹é…åŽŸå‰‡ï¼šå°‡æ‰€æœ‰ Key ä¾ç…§å­—æ•¸ã€Œç”±é•·åˆ°çŸ­ã€æŽ’åº
// ç¢ºä¿ã€Œå·®ä¸å¤šã€æœƒå„ªå…ˆæ–¼ã€Œå·®ã€è¢«æ›¿æ›ï¼Œé¿å…çŸ­è©žæ””æˆªé•·è©ž
export const SORTED_POLYPHONE_KEYS = Object.keys(POLYPHONE_MAP).sort((a, b) => b.length - a.length);

export const fixPolyphones = (text) => {
  if (!text || typeof text !== 'string') return text;
  
  let fixedText = text;
  
  SORTED_POLYPHONE_KEYS.forEach(word => {
    if (fixedText.includes(word)) {
      const replacement = POLYPHONE_MAP[word];
      fixedText = fixedText.split(word).join(replacement);
    }
  });
  
  return fixedText;
};